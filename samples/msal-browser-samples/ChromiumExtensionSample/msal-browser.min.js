/*! @azure/msal-browser v2.7.0 2020-12-03 */
"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).msal={})}(this,function(y){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function e(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var h=function(){return(h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function f(i,a,s,c){return new(s=s||Promise)(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}o((c=c.apply(i,a||[])).next())})}function g(r,n){var o,i,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function o(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function t(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var l=function(){return(l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function m(i,a,s,c){return new(s=s||Promise)(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}o((c=c.apply(i,a||[])).next())})}function E(r,n){var o,i,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function a(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}var s,r={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},c=(t(u,s=Error),u.createUnexpectedError=function(e){return new u(r.unexpectedError.code,r.unexpectedError.desc+": "+e)},u);function u(e,t,r){var n=this,o=t?e+": "+t:e;return n=s.call(this,o)||this,Object.setPrototypeOf(n,u.prototype),n.errorCode=e,n.errorMessage=t,n.suberror=r,n.name="AuthError",n}var d,p={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},v={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},C={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},T={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},w={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},S={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},I={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},A={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},R={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},_={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},b={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},O={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},k={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},N={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},P={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},U={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},L={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},M={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},D={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},q={code:"device_code_expired",desc:"Device code is expired."},H={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},K={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},x={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},F={code:"no_account_found",desc:"No account found in cache for given key."},G={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},B={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},j={code:"invalid_cache_type",desc:"Invalid cache type"},z={code:"unexpected_account_type",desc:"Unexpected account type."},W={code:"unexpected_credential_type",desc:"Unexpected credential type."},Y={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},J={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},V={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},Q=(t(X,d=c),X.createClientInfoDecodingError=function(e){return new X(p.code,p.desc+" Failed with error: "+e)},X.createClientInfoEmptyError=function(e){return new X(v.code,v.desc+" Given Object: "+e)},X.createTokenParsingError=function(e){return new X(C.code,C.desc+" Failed with error: "+e)},X.createTokenNullOrEmptyError=function(e){return new X(T.code,T.desc+" Raw Token Value: "+e)},X.createEndpointDiscoveryIncompleteError=function(e){return new X(w.code,w.desc+" Detail: "+e)},X.createHashNotDeserializedError=function(e){return new X(S.code,S.desc+" Given Object: "+e)},X.createInvalidStateError=function(e,t){return new X(I.code,I.desc+" Invalid State: "+e+", Root Err: "+t)},X.createStateMismatchError=function(){return new X(A.code,A.desc)},X.createNonceMismatchError=function(){return new X(R.code,R.desc)},X.createNoTokensFoundError=function(){return new X(_.code,_.desc)},X.createMultipleMatchingTokensInCacheError=function(){return new X(b.code,b.desc+".")},X.createMultipleMatchingAccountsInCacheError=function(){return new X(O.code,O.desc)},X.createMultipleMatchingAppMetadataInCacheError=function(){return new X(k.code,k.desc)},X.createTokenRequestCannotBeMadeError=function(){return new X(N.code,N.desc)},X.createAppendEmptyScopeToSetError=function(e){return new X(P.code,P.desc+" Given Scope: "+e)},X.createRemoveEmptyScopeFromSetError=function(e){return new X(U.code,U.desc+" Given Scope: "+e)},X.createAppendScopeSetError=function(e){return new X(L.code,L.desc+" Detail Error: "+e)},X.createEmptyInputScopeSetError=function(e){return new X(M.code,M.desc+" Given ScopeSet: "+e)},X.createDeviceCodeCancelledError=function(){return new X(D.code,""+D.desc)},X.createDeviceCodeExpiredError=function(){return new X(q.code,""+q.desc)},X.createNoAccountInSilentRequestError=function(){return new X(H.code,""+H.desc)},X.createNullOrUndefinedCacheRecord=function(){return new X(K.code,K.desc)},X.createInvalidCacheEnvironmentError=function(){return new X(x.code,x.desc)},X.createNoAccountFoundError=function(){return new X(F.code,F.desc)},X.createCachePluginError=function(){return new X(G.code,""+G.desc)},X.createNoCryptoObjectError=function(e){return new X(B.code,""+B.desc+e)},X.createInvalidCacheTypeError=function(){return new X(j.code,""+j.desc)},X.createUnexpectedAccountTypeError=function(){return new X(z.code,""+z.desc)},X.createUnexpectedCredentialTypeError=function(){return new X(W.code,""+W.desc)},X.createInvalidAssertionError=function(){return new X(Y.code,""+Y.desc)},X.createInvalidCredentialError=function(){return new X(J.code,""+J.desc)},X.createRefreshRequiredError=function(){return new X(V.code,V.desc)},X);function X(e,t){var r=d.call(this,e,t)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,X.prototype),r}var Z=($.decodeAuthToken=function(e){if($.isEmpty(e))throw Q.createTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw Q.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},$.isEmpty=function(e){return void 0===e||!e||0===e.length},$.startsWith=function(e,t){return 0===e.indexOf(t)},$.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},$.queryStringToObject=function(e){function t(e){return decodeURIComponent(decodeURIComponent(e.replace(n," ")))}var r,n=/\+/g,o=/([^&=]+)=([^&]*)/g,i={};for(r=o.exec(e);r;)i[t(r[1])]=t(r[2]),r=o.exec(e);return i},$.trimArrayEntries=function(e){return e.map(function(e){return e.trim()})},$.removeEmptyStringsFromArray=function(e){return e.filter(function(e){return!$.isEmpty(e)})},$.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},$);function $(){}var ee,te,re,ne,oe,ie,ae,se,ce,ue,he={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/"};(te=ee=ee||{}).CONTENT_TYPE="Content-Type",te.X_CLIENT_CURR_TELEM="x-client-current-telemetry",te.X_CLIENT_LAST_TELEM="x-client-last-telemetry",te.RETRY_AFTER="Retry-After",te.X_MS_LIB_CAPABILITY="x-ms-lib-capability",te.X_MS_LIB_CAPABILITY_VALUE="retry-after, h429",(ne=re=re||{}).ID_TOKEN="idtoken",ne.CLIENT_INFO="client.info",ne.ADAL_ID_TOKEN="adal.idtoken",ne.ERROR="error",ne.ERROR_DESC="error.description",(ie=oe=oe||{}).COMMON="common",ie.ORGANIZATIONS="organizations",ie.CONSUMERS="consumers",(se=ae=ae||{}).CLIENT_ID="client_id",se.REDIRECT_URI="redirect_uri",se.RESPONSE_TYPE="response_type",se.RESPONSE_MODE="response_mode",se.GRANT_TYPE="grant_type",se.CLAIMS="claims",se.SCOPE="scope",se.ERROR="error",se.ERROR_DESCRIPTION="error_description",se.ACCESS_TOKEN="access_token",se.ID_TOKEN="id_token",se.REFRESH_TOKEN="refresh_token",se.EXPIRES_IN="expires_in",se.STATE="state",se.NONCE="nonce",se.PROMPT="prompt",se.SESSION_STATE="session_state",se.CLIENT_INFO="client_info",se.CODE="code",se.CODE_CHALLENGE="code_challenge",se.CODE_CHALLENGE_METHOD="code_challenge_method",se.CODE_VERIFIER="code_verifier",se.CLIENT_REQUEST_ID="client-request-id",se.X_CLIENT_SKU="x-client-SKU",se.X_CLIENT_VER="x-client-VER",se.X_CLIENT_OS="x-client-OS",se.X_CLIENT_CPU="x-client-CPU",se.POST_LOGOUT_URI="post_logout_redirect_uri",se.ID_TOKEN_HINT="id_token_hint",se.DEVICE_CODE="device_code",se.CLIENT_SECRET="client_secret",se.CLIENT_ASSERTION="client_assertion",se.CLIENT_ASSERTION_TYPE="client_assertion_type",se.TOKEN_TYPE="token_type",se.REQ_CNF="req_cnf",se.OBO_ASSERTION="assertion",se.REQUESTED_TOKEN_USE="requested_token_use",se.ON_BEHALF_OF="on_behalf_of",se.FOCI="foci",(ue=ce=ce||{}).ACCESS_TOKEN="access_token",ue.XMS_CC="xms_cc";var de,le,pe={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};(le=de=de||{}).ACCOUNT="account",le.SID="sid",le.LOGIN_HINT="login_hint",le.ID_TOKEN="id_token",le.DOMAIN_HINT="domain_hint",le.ORGANIZATIONS="organizations",le.CONSUMERS="consumers",le.ACCOUNT_ID="accountIdentifier",le.HOMEACCOUNT_ID="homeAccountIdentifier";de.SID,de.LOGIN_HINT;var fe,ye,ge,me,Ee,ve,Ce,Te,we,Se,Ie,Ae,Re,_e,be={PLAIN:"plain",S256:"S256"};(ye=fe=fe||{}).QUERY="query",ye.FRAGMENT="fragment",ye.FORM_POST="form_post",(me=ge=ge||{}).IMPLICIT_GRANT="implicit",me.AUTHORIZATION_CODE_GRANT="authorization_code",me.CLIENT_CREDENTIALS_GRANT="client_credentials",me.RESOURCE_OWNER_PASSWORD_GRANT="password",me.REFRESH_TOKEN_GRANT="refresh_token",me.DEVICE_CODE_GRANT="device_code",me.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer",(ve=Ee=Ee||{}).MSSTS_ACCOUNT_TYPE="MSSTS",ve.ADFS_ACCOUNT_TYPE="ADFS",ve.MSAV1_ACCOUNT_TYPE="MSA",ve.GENERIC_ACCOUNT_TYPE="Generic",(Te=Ce=Ce||{}).CACHE_KEY_SEPARATOR="-",Te.CLIENT_INFO_SEPARATOR=".",(Se=we=we||{}).ID_TOKEN="IdToken",Se.ACCESS_TOKEN="AccessToken",Se.REFRESH_TOKEN="RefreshToken",(Ae=Ie=Ie||{}).ACCOUNT="Account",Ae.CREDENTIAL="Credential",Ae.ID_TOKEN="IdToken",Ae.ACCESS_TOKEN="AccessToken",Ae.REFRESH_TOKEN="RefreshToken",Ae.APP_METADATA="AppMetadata",Ae.TEMPORARY="TempCache",Ae.TELEMETRY="Telemetry",Ae.UNDEFINED="Undefined",Ae.THROTTLING="Throttling",(_e=Re=Re||{})[_e.ADFS=1001]="ADFS",_e[_e.MSA=1002]="MSA",_e[_e.MSSTS=1003]="MSSTS",_e[_e.GENERIC=1004]="GENERIC",_e[_e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",_e[_e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",_e[_e.ID_TOKEN=2003]="ID_TOKEN",_e[_e.APP_METADATA=3001]="APP_METADATA",_e[_e.UNDEFINED=9999]="UNDEFINED";var Oe,ke="appmetadata",Ne="1",Pe={SCHEMA_VERSION:2,MAX_HEADER_BYTES:4e3,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};(Oe=y.AuthenticationScheme||(y.AuthenticationScheme={})).POP="pop",Oe.BEARER="Bearer";var Ue,Le,Me,De=60,qe=3600,He="throttling",Ke="invalid_grant",xe="client_mismatch";(Le=Ue=Ue||{}).username="username",Le.password="password",(Me=y.LogLevel||(y.LogLevel={}))[Me.Error=0]="Error",Me[Me.Warning=1]="Warning",Me[Me.Info=2]="Info",Me[Me.Verbose=3]="Verbose";var Fe=(Ge.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(Z.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+y.LogLevel[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii)}},Ge.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},Ge.prototype.error=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Error,containsPii:!1,correlationId:t||""})},Ge.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Error,containsPii:!0,correlationId:t||""})},Ge.prototype.warning=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Warning,containsPii:!1,correlationId:t||""})},Ge.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Warning,containsPii:!0,correlationId:t||""})},Ge.prototype.info=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Info,containsPii:!1,correlationId:t||""})},Ge.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Info,containsPii:!0,correlationId:t||""})},Ge.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Verbose,containsPii:!1,correlationId:t||""})},Ge.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Verbose,containsPii:!0,correlationId:t||""})},Ge.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Ge);function Ge(e,t,r){this.level=y.LogLevel.Info,e&&(this.localCallback=e.loggerCallback,this.piiLoggingEnabled=e.piiLoggingEnabled,this.level=e.logLevel),this.packageName=t||he.EMPTY_STRING,this.packageVersion=r||he.EMPTY_STRING}var Be="1.7.2",je=(ze.prototype.generateAccountId=function(){return ze.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},ze.prototype.generateCredentialId=function(){return ze.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},ze.prototype.generateTarget=function(){return ze.generateTargetForCacheKey(this.target)},ze.prototype.generateCredentialKey=function(){return ze.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},ze.prototype.generateType=function(){switch(this.credentialType){case we.ID_TOKEN:return Re.ID_TOKEN;case we.ACCESS_TOKEN:return Re.ACCESS_TOKEN;case we.REFRESH_TOKEN:return Re.REFRESH_TOKEN;default:throw Q.createUnexpectedCredentialTypeError()}},ze.getCredentialType=function(e){return-1!==e.indexOf(we.ACCESS_TOKEN.toLowerCase())?we.ACCESS_TOKEN:-1!==e.indexOf(we.ID_TOKEN.toLowerCase())?we.ID_TOKEN:-1!==e.indexOf(we.REFRESH_TOKEN.toLowerCase())?we.REFRESH_TOKEN:he.NOT_DEFINED},ze.generateCredentialCacheKey=function(e,t,r,n,o,i,a){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i)].join(Ce.CACHE_KEY_SEPARATOR).toLowerCase()},ze.generateAccountIdForCacheKey=function(e,t){return[e,t].join(Ce.CACHE_KEY_SEPARATOR).toLowerCase()},ze.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===we.REFRESH_TOKEN&&n||t,r||""].join(Ce.CACHE_KEY_SEPARATOR).toLowerCase()},ze.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},ze);function ze(){}var We,Ye={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Je={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Ve={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Qe={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Xe={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},Ze={code:"empty_url_error",desc:"URL was empty or null."},$e={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},et={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},tt={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},rt={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},nt={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},ot={code:"token_request_empty",desc:"Token request was empty and not found in cache."},it={code:"logout_request_empty",desc:"The logout request was null or undefined."},at={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},st={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},ct={code:"invalid_known_authorities",desc:"knownAuthorities and cloudDiscoveryMetadata cannot both be provided. Please provide cloudDiscoveryMetadata object for AAD, knownAuthorities otherwise."},ut={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},ht={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},dt=(t(lt,We=Q),lt.createRedirectUriEmptyError=function(){return new lt(Ye.code,Ye.desc)},lt.createPostLogoutRedirectUriEmptyError=function(){return new lt(Je.code,Je.desc)},lt.createClaimsRequestParsingError=function(e){return new lt(Ve.code,Ve.desc+" Given value: "+e)},lt.createInsecureAuthorityUriError=function(e){return new lt(Qe.code,Qe.desc+" Given URI: "+e)},lt.createUrlParseError=function(e){return new lt(Xe.code,Xe.desc+" Given Error: "+e)},lt.createUrlEmptyError=function(){return new lt(Ze.code,Ze.desc)},lt.createScopesNonArrayError=function(e){return new lt(et.code,et.desc+" Given Scopes: "+e)},lt.createEmptyScopesArrayError=function(e){return new lt($e.code,$e.desc+" Given Scopes: "+e)},lt.createClientIdSingleScopeError=function(e){return new lt(tt.code,tt.desc+" Given Scopes: "+e)},lt.createInvalidPromptError=function(e){return new lt(rt.code,rt.desc+" Given value: "+e)},lt.createInvalidClaimsRequestError=function(){return new lt(nt.code,nt.desc)},lt.createEmptyLogoutRequestError=function(){return new lt(it.code,it.desc)},lt.createEmptyTokenRequestError=function(){return new lt(ot.code,ot.desc)},lt.createInvalidCodeChallengeMethodError=function(){return new lt(at.code,at.desc)},lt.createInvalidCodeChallengeParamsError=function(){return new lt(st.code,st.desc)},lt.createKnownAuthoritiesCloudDiscoveryMetadataError=function(){return new lt(ct.code,ct.desc)},lt.createInvalidCloudDiscoveryMetadataError=function(){return new lt(ut.code,ut.desc)},lt.createUntrustedAuthorityError=function(){return new lt(ht.code,ht.desc)},lt);function lt(e,t){var r=We.call(this,e,t)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,lt.prototype),r}var pt,ft,yt=(gt.fromString=function(e){return new gt((e=e||"").split(" "))},gt.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw dt.createEmptyScopesArrayError(e)},gt.prototype.containsScope=function(e){var t=new gt(this.printScopesLowerCase().split(" "));return!Z.isEmpty(e)&&t.scopes.has(e.toLowerCase())},gt.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(e){return t.containsScope(e)})},gt.prototype.containsOnlyDefaultScopes=function(){var e=0;return this.containsScope(he.OPENID_SCOPE)&&(e+=1),this.containsScope(he.PROFILE_SCOPE)&&(e+=1),this.containsScope(he.OFFLINE_ACCESS_SCOPE)&&(e+=1),this.scopes.size===e},gt.prototype.appendScope=function(e){Z.isEmpty(e)||this.scopes.add(e.trim())},gt.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(e){return t.appendScope(e)})}catch(e){throw Q.createAppendScopeSetError(e)}},gt.prototype.removeScope=function(e){if(Z.isEmpty(e))throw Q.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},gt.prototype.removeDefaultScopes=function(){this.scopes.delete(he.OFFLINE_ACCESS_SCOPE),this.scopes.delete(he.OPENID_SCOPE),this.scopes.delete(he.PROFILE_SCOPE)},gt.prototype.unionScopeSets=function(e){if(!e)throw Q.createEmptyInputScopeSetError(e);var t=new Set;return e.scopes.forEach(function(e){return t.add(e.toLowerCase())}),this.scopes.forEach(function(e){return t.add(e.toLowerCase())}),t},gt.prototype.intersectingScopeSets=function(e){if(!e)throw Q.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e);e.containsOnlyDefaultScopes()||e.removeDefaultScopes();var r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},gt.prototype.getScopeCount=function(){return this.scopes.size},gt.prototype.asArray=function(){var t=[];return this.scopes.forEach(function(e){return t.push(e)}),t},gt.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},gt.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},gt);function gt(e){var t=this,r=e?Z.trimArrayEntries(a(e)):[],n=r?Z.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(function(e){return t.scopes.add(e)})}(ft=pt=pt||{})[ft.Default=0]="Default",ft[ft.Adfs=1]="Adfs";var mt=(Object.defineProperty(Et.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),Et.canonicalizeUri=function(e){return(e=e&&e.toLowerCase())&&!Z.endsWith(e,"/")&&(e+="/"),e},Et.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw dt.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw dt.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw dt.createInsecureAuthorityUriError(this.urlString)},Et.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},Et.removeHashFromUrl=function(e){return Et.canonicalizeUri(e.split("#")[0])},Et.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==oe.COMMON&&r[0]!==oe.ORGANIZATIONS||(r[0]=e),Et.constructAuthorityUriFromObject(t)},Et.prototype.getHash=function(){return Et.parseHash(this.urlString)},Et.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw dt.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter(function(e){return e&&0<e.length}),r.PathSegments=n,!Z.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},Et.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw dt.createUrlParseError("Given url string: "+e);return r[2]},Et.getAbsoluteUrl=function(e,t){if(e[0]!==he.FORWARD_SLASH)return e;var r=new Et(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e},Et.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return-1<r?e.substring(r+2):-1<t?e.substring(t+1):""},Et.constructAuthorityUriFromObject=function(e){return new Et(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},Et.getDeserializedHash=function(e){if(Z.isEmpty(e))return{};var t=Et.parseHash(e),r=Z.queryStringToObject(Z.isEmpty(t)?e:t);if(!r)throw Q.createHashNotDeserializedError(JSON.stringify(r));return r},Et.hashContainsKnownProperties=function(e){if(Z.isEmpty(e))return!1;var t=Et.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},Et);function Et(e){if(this._urlString=e,Z.isEmpty(this._urlString))throw dt.createUrlEmptyError();Z.isEmpty(this.getHash())&&(this._urlString=Et.canonicalizeUri(e))}var vt,Ct=(Tt.setTrustedAuthoritiesFromConfig=function(e,t){if(!this.getTrustedHostList().length){if(0<e.length&&!Z.isEmpty(t))throw dt.createKnownAuthoritiesCloudDiscoveryMetadataError();this.createCloudDiscoveryMetadataFromKnownAuthorities(e);try{if(t){var r=JSON.parse(t);this.saveCloudDiscoveryMetadata(r.metadata)}}catch(e){throw dt.createInvalidCloudDiscoveryMetadataError()}}},Tt.setTrustedAuthoritiesFromNetwork=function(i,a){return m(this,void 0,void 0,function(){var t,r,n,o;return E(this,function(e){switch(e.label){case 0:t=""+he.AAD_INSTANCE_DISCOVERY_ENDPT+i.urlString+"oauth2/v2.0/authorize",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,a.sendGetRequestAsync(t)];case 2:return r=e.sent(),n=r.body.metadata,this.saveCloudDiscoveryMetadata(n),[3,4];case 3:return e.sent(),[2];case 4:return o=i.getUrlComponents().HostNameAndPort,0<this.getTrustedHostList().length&&!this.IsInTrustedHostList(o)&&this.createCloudDiscoveryMetadataFromKnownAuthorities([o]),[2]}})})},Tt.saveCloudDiscoveryMetadata=function(e){e.forEach(function(t){t.aliases.forEach(function(e){Tt.TrustedHostList[e.toLowerCase()]=t})})},Tt.createCloudDiscoveryMetadataFromKnownAuthorities=function(e){var r=this;e.forEach(function(e){var t=mt.getDomainFromUrl(e).toLowerCase();r.TrustedHostList[t]={preferred_cache:t,preferred_network:t,aliases:[t]}})},Tt.getTrustedHostList=function(){return Object.keys(this.TrustedHostList)},Tt.getCloudDiscoveryMetadata=function(e){return this.TrustedHostList[e.toLowerCase()]||null},Tt.IsInTrustedHostList=function(e){return-1<Object.keys(this.TrustedHostList).indexOf(e.toLowerCase())},Tt.TrustedHostList={},Tt);function Tt(){}(vt=y.ProtocolMode||(y.ProtocolMode={})).AAD="AAD",vt.OIDC="OIDC";var wt=(Object.defineProperty(St.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===he.ADFS?pt.Adfs:pt.Default},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"protocolMode",{get:function(){return this.authorityProtocolMode},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new mt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw Q.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw Q.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.tenantDiscoveryResponse.token_endpoint.replace("/token","/devicecode");throw Q.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw Q.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(St.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw Q.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),St.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},Object.defineProperty(St.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===pt.Adfs||this.protocolMode===y.ProtocolMode.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),St.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},St.prototype.discoverEndpoints=function(t){return m(this,void 0,void 0,function(){return E(this,function(e){return[2,this.networkInterface.sendGetRequestAsync(t)]})})},Object.defineProperty(St.prototype,"aadInstanceDiscoveryEndpointUrl",{get:function(){return""+he.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),St.prototype.validateAndSetPreferredNetwork=function(){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:return t=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==Ct.getTrustedHostList().length?[3,2]:[4,Ct.setTrustedAuthoritiesFromNetwork(this._canonicalAuthority,this.networkInterface)];case 1:e.sent(),e.label=2;case 2:if(!Ct.IsInTrustedHostList(t))throw dt.createUntrustedAuthorityError();return r=Ct.getCloudDiscoveryMetadata(t).preferred_network,t!==r&&(this.canonicalAuthority=this.canonicalAuthority.replace(t,r)),[2]}})})},St.prototype.resolveEndpointsAsync=function(){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:return[4,this.validateAndSetPreferredNetwork()];case 1:return e.sent(),t=this.defaultOpenIdConfigurationEndpoint,[4,this.discoverEndpoints(t)];case 2:return r=e.sent(),this.tenantDiscoveryResponse=r.body,[2]}})})},St.generateEnvironmentFromAuthority=function(e){var t=e.canonicalAuthorityUrlComponents.HostNameAndPort;return Ct.getCloudDiscoveryMetadata(t)?Ct.getCloudDiscoveryMetadata(t).preferred_cache:""},St);function St(e,t,r){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.authorityProtocolMode=r}function It(e,t){if(Z.isEmpty(e))throw Q.createClientInfoEmptyError(e);try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw Q.createClientInfoDecodingError(e)}}var At=(Rt.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Ce.CACHE_KEY_SEPARATOR).toLowerCase()},Rt.prototype.generateAccountKey=function(){return Rt.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},Rt.prototype.generateType=function(){switch(this.authorityType){case Ee.ADFS_ACCOUNT_TYPE:return Re.ADFS;case Ee.MSAV1_ACCOUNT_TYPE:return Re.MSA;case Ee.MSSTS_ACCOUNT_TYPE:return Re.MSSTS;case Ee.GENERIC_ACCOUNT_TYPE:return Re.GENERIC;default:throw Q.createUnexpectedAccountTypeError()}},Rt.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name}},Rt.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(Ce.CACHE_KEY_SEPARATOR).toLowerCase()},Rt.createAccount=function(e,t,r,n,o){var i=new Rt;i.authorityType=Ee.MSSTS_ACCOUNT_TYPE,i.clientInfo=e,i.homeAccountId=t;var a=wt.generateEnvironmentFromAuthority(r);if(Z.isEmpty(a))throw Q.createInvalidCacheEnvironmentError();if(i.environment=a,i.realm=n.claims.tid||"",i.oboAssertion=o,n){var s=Z.isEmpty(n.claims.oid)?n.claims.sub:n.claims.oid;i.localAccountId=s,i.username=n.claims.preferred_username||(n.claims.emails?n.claims.emails[0]:""),i.name=n.claims.name}return i},Rt.createGenericAccount=function(e,t,r,n){var o=new Rt;o.authorityType=e.authorityType===pt.Adfs?Ee.ADFS_ACCOUNT_TYPE:Ee.GENERIC_ACCOUNT_TYPE,o.homeAccountId=t,o.realm="",o.oboAssertion=n;var i=wt.generateEnvironmentFromAuthority(e);if(Z.isEmpty(i))throw Q.createInvalidCacheEnvironmentError();if(r){var a=Z.isEmpty(r.claims.oid)?r.claims.sub:r.claims.oid;o.localAccountId=a,o.username=r.claims.upn,o.name=r.claims.name}return o.environment=i,o},Rt.generateHomeAccountId=function(e,t,r,n,o){var i=o&&o.claims.sub?o.claims.sub:"";if(t===pt.Adfs)return i;if(e){var a=It(e,n);if(!Z.isEmpty(a.uid)&&!Z.isEmpty(a.utid))return""+a.uid+Ce.CLIENT_INFO_SEPARATOR+a.utid}return r.verbose("No client info in response"),i},Rt.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},Rt);function Rt(){}var _t=(bt.prototype.getAllAccounts=function(){var t=this.getAccountsFilteredBy(),e=Object.keys(t).map(function(e){return t[e]});return e.length<1?[]:e.map(function(e){var t=new At;return(t=bt.toObject(t,e)).getAccountInfo()})},bt.prototype.saveCacheRecord=function(e){if(!e)throw Q.createNullOrUndefinedCacheRecord();e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)},bt.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:we.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),n=yt.fromString(e.target),o=Object.keys(r.accessTokens).map(function(e){return r.accessTokens[e]});o&&o.forEach(function(e){yt.fromString(e.target).intersectingScopeSets(n)&&t.removeCredential(e)}),this.setAccessTokenCredential(e)},bt.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},bt.prototype.getAccountsFilteredByInternal=function(r,n,o){var i=this,e=this.getKeys(),a={};return e.forEach(function(e){var t=i.getAccount(e);if(!t)return null;(Z.isEmpty(r)||i.matchHomeAccountId(t,r))&&(Z.isEmpty(n)||i.matchEnvironment(t,n))&&(Z.isEmpty(o)||i.matchRealm(t,o))&&(a[e]=t)}),a},bt.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion)},bt.prototype.getCredentialsFilteredByInternal=function(n,o,i,a,s,c,u,h){var d=this,e=this.getKeys(),l={idTokens:{},accessTokens:{},refreshTokens:{}};return e.forEach(function(e){var t=je.getCredentialType(e);if(t!==he.NOT_DEFINED){var r=d.getSpecificCredential(e,t);if(r&&(Z.isEmpty(h)||d.matchOboAssertion(r,h))&&(Z.isEmpty(n)||d.matchHomeAccountId(r,n))&&(Z.isEmpty(o)||d.matchEnvironment(r,o))&&(Z.isEmpty(c)||d.matchRealm(r,c))&&(Z.isEmpty(i)||d.matchCredentialType(r,i))&&(Z.isEmpty(a)||d.matchClientId(r,a))&&(Z.isEmpty(s)||d.matchFamilyId(r,s))&&(Z.isEmpty(u)||d.matchTarget(r,u)))switch(t){case we.ID_TOKEN:l.idTokens[e]=r;break;case we.ACCESS_TOKEN:l.accessTokens[e]=r;break;case we.REFRESH_TOKEN:l.refreshTokens[e]=r}}}),l},bt.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},bt.prototype.getAppMetadataFilteredByInternal=function(r,n){var o=this,e=this.getKeys(),i={};return e.forEach(function(e){if(o.isAppMetadata(e)){var t=o.getAppMetadata(e);t&&(Z.isEmpty(r)||o.matchEnvironment(t,r))&&(Z.isEmpty(n)||o.matchClientId(t,n))&&(i[e]=t)}}),i},bt.prototype.removeAllAccounts=function(){var t=this;return this.getKeys().forEach(function(e){t.getAccount(e)&&t.removeAccount(e)}),!0},bt.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw Q.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,Ie.ACCOUNT)},bt.prototype.removeAccountContext=function(e){var n=this,t=this.getKeys(),o=e.generateAccountId();return t.forEach(function(e){var t=je.getCredentialType(e);if(t!==he.NOT_DEFINED){var r=n.getSpecificCredential(e,t);r&&o===r.generateAccountId()&&n.removeCredential(r)}}),!0},bt.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,Ie.CREDENTIAL)},bt.prototype.removeAppMetadata=function(){var t=this;return this.getKeys().forEach(function(e){t.isAppMetadata(e)&&t.removeItem(e,Ie.APP_METADATA)}),!0},bt.prototype.readCacheRecord=function(e,t,r,n){return{account:this.readAccountFromCache(e),idToken:this.readIdTokenFromCache(t,e),accessToken:this.readAccessTokenFromCache(t,e,r),refreshToken:this.readRefreshTokenFromCache(t,e,!1),appMetadata:this.readAppMetadataFromCache(n,t)}},bt.prototype.readAccountFromCache=function(e){var t=At.generateAccountCacheKey(e);return this.getAccount(t)},bt.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:we.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),o=Object.keys(n.idTokens).map(function(e){return n.idTokens[e]}),i=o.length;if(i<1)return null;if(1<i)throw Q.createMultipleMatchingTokensInCacheError();return o[0]},bt.prototype.readAccessTokenFromCache=function(e,t,r){var n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:we.ACCESS_TOKEN,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase()},o=this.getCredentialsFilteredBy(n),i=Object.keys(o.accessTokens).map(function(e){return o.accessTokens[e]}),a=i.length;if(a<1)return null;if(1<a)throw Q.createMultipleMatchingTokensInCacheError();return i[0]},bt.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?Ne:null,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:we.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),a=Object.keys(i.refreshTokens).map(function(e){return i.refreshTokens[e]});return a.length<1?null:a[0]},bt.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map(function(e){return n[e]}),i=o.length;if(i<1)return null;if(1<i)throw Q.createMultipleMatchingAppMetadataInCacheError();return o[0]},bt.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return r&&r.familyId===Ne},bt.prototype.matchHomeAccountId=function(e,t){return e.homeAccountId&&t===e.homeAccountId},bt.prototype.matchOboAssertion=function(e,t){return e.oboAssertion&&t===e.oboAssertion},bt.prototype.matchEnvironment=function(e,t){var r=Ct.getCloudDiscoveryMetadata(t);return!!(r&&-1<r.aliases.indexOf(e.environment))},bt.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},bt.prototype.matchClientId=function(e,t){return e.clientId&&t===e.clientId},bt.prototype.matchFamilyId=function(e,t){return e.familyId&&t===e.familyId},bt.prototype.matchRealm=function(e,t){return e.realm&&t===e.realm},bt.prototype.matchTarget=function(e,t){if(e.credentialType!==we.ACCESS_TOKEN||Z.isEmpty(e.target))return!1;var r=yt.fromString(e.target),n=yt.fromString(t);return n.containsOnlyDefaultScopes()||n.removeDefaultScopes(),r.containsScopeSet(n)},bt.prototype.isAppMetadata=function(e){return-1!==e.indexOf(ke)},bt.prototype.getSpecificCredential=function(e,t){switch(t){case we.ID_TOKEN:return this.getIdTokenCredential(e);case we.ACCESS_TOKEN:return this.getAccessTokenCredential(e);case we.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},bt.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},bt);function bt(){}var Ot,kt=(t(Nt,Ot=_t),Nt.prototype.setAccount=function(){throw c.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},Nt.prototype.getAccount=function(){throw c.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},Nt.prototype.setIdTokenCredential=function(){throw c.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},Nt.prototype.getIdTokenCredential=function(){throw c.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},Nt.prototype.setAccessTokenCredential=function(){throw c.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},Nt.prototype.getAccessTokenCredential=function(){throw c.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},Nt.prototype.setRefreshTokenCredential=function(){throw c.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},Nt.prototype.getRefreshTokenCredential=function(){throw c.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},Nt.prototype.setAppMetadata=function(){throw c.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},Nt.prototype.getAppMetadata=function(){throw c.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},Nt.prototype.setServerTelemetry=function(){throw c.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},Nt.prototype.getServerTelemetry=function(){throw c.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},Nt.prototype.setThrottlingCache=function(){throw c.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},Nt.prototype.getThrottlingCache=function(){throw c.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},Nt.prototype.removeItem=function(){throw c.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},Nt.prototype.containsKey=function(){throw c.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},Nt.prototype.getKeys=function(){throw c.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},Nt.prototype.clear=function(){throw c.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},Nt);function Nt(){return null!==Ot&&Ot.apply(this,arguments)||this}var Pt={clientId:"",authority:null,knownAuthorities:[],cloudDiscoveryMetadata:"",clientCapabilities:[],protocolMode:y.ProtocolMode.AAD},Ut={tokenRenewalOffsetSeconds:300},Lt={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:y.LogLevel.Info},Mt={sendGetRequestAsync:function(){return m(this,void 0,void 0,function(){return E(this,function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",c.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return m(this,void 0,void 0,function(){return E(this,function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",c.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},Dt={createNewGuid:function(){throw c.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw c.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw c.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return m(this,void 0,void 0,function(){return E(this,function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",c.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})},getPublicKeyThumbprint:function(){return m(this,void 0,void 0,function(){return E(this,function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",c.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")})})},signJwt:function(){return m(this,void 0,void 0,function(){return E(this,function(e){throw"Crypto interface - signJwt() has not been implemented",c.createUnexpectedError("Crypto interface - signJwt() has not been implemented")})})}},qt={sku:he.SKU,version:Be,cpu:"",os:""},Ht={clientSecret:"",clientAssertion:null};var Kt,xt=(t(Ft,Kt=c),Ft);function Ft(e,t,r){var n=Kt.call(this,e,t)||this;return n.name="ServerError",n.subError=r,Object.setPrototypeOf(n,Ft.prototype),n}var Gt=(Bt.generateThrottlingStorageKey=function(e){return He+"."+JSON.stringify(e)},Bt.preProcess=function(e,t){var r=Bt.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){if(n.throttleTime<Date.now())return void e.removeItem(r,Ie.THROTTLING);throw new xt(n.errorCodes.join(" "),n.errorMessage,n.subError)}},Bt.postProcess=function(e,t,r){if(Bt.checkResponseStatus(r)||Bt.checkResponseForRetryAfter(r)){var n={throttleTime:Bt.calculateThrottleTime(parseInt(r.headers[ee.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Bt.generateThrottlingStorageKey(t),n)}},Bt.checkResponseStatus=function(e){return 429==e.status||500<=e.status&&e.status<600},Bt.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(ee.RETRY_AFTER)&&(e.status<200||300<=e.status)},Bt.calculateThrottleTime=function(e){e<=0&&(e=null);var t=Date.now()/1e3;return Math.floor(1e3*Math.min(t+(e||De),t+qe))},Bt.removeThrottle=function(e,t,r,n,o){var i={clientId:t,authority:r,scopes:n,homeAccountIdentifier:o},a=this.generateThrottlingStorageKey(i);return e.removeItem(a,Ie.THROTTLING)},Bt);function Bt(){}var jt=(zt.prototype.sendPostRequest=function(r,n,o){return m(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return Gt.preProcess(this.cacheManager,r),[4,this.networkClient.sendPostRequestAsync(n,o)];case 1:return t=e.sent(),Gt.postProcess(this.cacheManager,r,t),[2,t]}})})},zt);function zt(e,t){this.networkClient=e,this.cacheManager=t}var Wt=(Yt.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e[ee.CONTENT_TYPE]=he.URL_FORM_CONTENT_TYPE,e[ee.X_MS_LIB_CAPABILITY]=ee.X_MS_LIB_CAPABILITY_VALUE,this.serverTelemetryManager&&(e[ee.X_CLIENT_CURR_TELEM]=this.serverTelemetryManager.generateCurrentRequestHeaderValue(),e[ee.X_CLIENT_LAST_TELEM]=this.serverTelemetryManager.generateLastRequestHeaderValue()),e},Yt.prototype.createDefaultLibraryHeaders=function(){var e={};return e[ae.X_CLIENT_SKU]=this.config.libraryInfo.sku,e[ae.X_CLIENT_VER]=this.config.libraryInfo.version,e[ae.X_CLIENT_OS]=this.config.libraryInfo.os,e[ae.X_CLIENT_CPU]=this.config.libraryInfo.cpu,e},Yt.prototype.executePostToTokenEndpoint=function(r,n,o,i){return m(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return[4,this.networkManager.sendPostRequest(i,r,{body:n,headers:o})];case 1:return t=e.sent(),this.config.serverTelemetryManager&&t.status<500&&429!==t.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,t]}})})},Yt);function Yt(e){this.config=function(e){var t=e.authOptions,r=e.systemOptions,n=e.loggerOptions,o=e.storageInterface,i=e.networkInterface,a=e.cryptoInterface,s=e.clientCredentials,c=e.libraryInfo,u=e.serverTelemetryManager,h=e.persistencePlugin,d=e.serializableCache;return{authOptions:l(l({},Pt),t),systemOptions:l(l({},Ut),r),loggerOptions:l(l({},Lt),n),storageInterface:o||new kt,networkInterface:i||Mt,cryptoInterface:a||Dt,clientCredentials:s||Ht,libraryInfo:l(l({},qt),c),serverTelemetryManager:u||null,persistencePlugin:h||null,serializableCache:d||null}}(e),this.logger=new Fe(this.config.loggerOptions,"@azure/msal-common",Be),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new jt(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,Ct.setTrustedAuthoritiesFromConfig(this.config.authOptions.knownAuthorities,this.config.authOptions.cloudDiscoveryMetadata),this.authority=this.config.authOptions.authority}var Jt=(Vt.validateRedirectUri=function(e){if(Z.isEmpty(e))throw dt.createRedirectUriEmptyError()},Vt.validatePrompt=function(e){if([pe.LOGIN,pe.SELECT_ACCOUNT,pe.CONSENT,pe.NONE].indexOf(e)<0)throw dt.createInvalidPromptError(e)},Vt.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw dt.createInvalidClaimsRequestError()}},Vt.validateCodeChallengeParams=function(e,t){if(Z.isEmpty(e)||Z.isEmpty(t))throw dt.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},Vt.validateCodeChallengeMethod=function(e){if([be.PLAIN,be.S256].indexOf(e)<0)throw dt.createInvalidCodeChallengeMethodError()},Vt.sanitizeEQParams=function(r,e){return r?(e.forEach(function(e,t){r[t]&&delete r[t]}),r):null},Vt);function Vt(){}var Qt=(Xt.prototype.addResponseTypeCode=function(){this.parameters.set(ae.RESPONSE_TYPE,encodeURIComponent(he.CODE_RESPONSE_TYPE))},Xt.prototype.addResponseMode=function(e){this.parameters.set(ae.RESPONSE_MODE,encodeURIComponent(e||fe.QUERY))},Xt.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?a(e||[],[he.OPENID_SCOPE,he.PROFILE_SCOPE]):e||[],n=new yt(r);this.parameters.set(ae.SCOPE,encodeURIComponent(n.printScopes()))},Xt.prototype.addClientId=function(e){this.parameters.set(ae.CLIENT_ID,encodeURIComponent(e))},Xt.prototype.addRedirectUri=function(e){Jt.validateRedirectUri(e),this.parameters.set(ae.REDIRECT_URI,encodeURIComponent(e))},Xt.prototype.addPostLogoutRedirectUri=function(e){Jt.validateRedirectUri(e),this.parameters.set(ae.POST_LOGOUT_URI,encodeURIComponent(e))},Xt.prototype.addIdTokenHint=function(e){this.parameters.set(ae.ID_TOKEN_HINT,encodeURIComponent(e))},Xt.prototype.addDomainHint=function(e){this.parameters.set(de.DOMAIN_HINT,encodeURIComponent(e))},Xt.prototype.addLoginHint=function(e){this.parameters.set(de.LOGIN_HINT,encodeURIComponent(e))},Xt.prototype.addSid=function(e){this.parameters.set(de.SID,encodeURIComponent(e))},Xt.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Jt.validateClaims(r),this.parameters.set(ae.CLAIMS,encodeURIComponent(r))},Xt.prototype.addCorrelationId=function(e){this.parameters.set(ae.CLIENT_REQUEST_ID,encodeURIComponent(e))},Xt.prototype.addLibraryInfo=function(e){this.parameters.set(ae.X_CLIENT_SKU,e.sku),this.parameters.set(ae.X_CLIENT_VER,e.version),this.parameters.set(ae.X_CLIENT_OS,e.os),this.parameters.set(ae.X_CLIENT_CPU,e.cpu)},Xt.prototype.addPrompt=function(e){Jt.validatePrompt(e),this.parameters.set(""+ae.PROMPT,encodeURIComponent(e))},Xt.prototype.addState=function(e){Z.isEmpty(e)||this.parameters.set(ae.STATE,encodeURIComponent(e))},Xt.prototype.addNonce=function(e){this.parameters.set(ae.NONCE,encodeURIComponent(e))},Xt.prototype.addCodeChallengeParams=function(e,t){if(Jt.validateCodeChallengeParams(e,t),!e||!t)throw dt.createInvalidCodeChallengeParamsError();this.parameters.set(ae.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(ae.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},Xt.prototype.addAuthorizationCode=function(e){this.parameters.set(ae.CODE,encodeURIComponent(e))},Xt.prototype.addDeviceCode=function(e){this.parameters.set(ae.DEVICE_CODE,encodeURIComponent(e))},Xt.prototype.addRefreshToken=function(e){this.parameters.set(ae.REFRESH_TOKEN,encodeURIComponent(e))},Xt.prototype.addCodeVerifier=function(e){this.parameters.set(ae.CODE_VERIFIER,encodeURIComponent(e))},Xt.prototype.addClientSecret=function(e){this.parameters.set(ae.CLIENT_SECRET,encodeURIComponent(e))},Xt.prototype.addClientAssertion=function(e){this.parameters.set(ae.CLIENT_ASSERTION,encodeURIComponent(e))},Xt.prototype.addClientAssertionType=function(e){this.parameters.set(ae.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},Xt.prototype.addOboAssertion=function(e){this.parameters.set(ae.OBO_ASSERTION,encodeURIComponent(e))},Xt.prototype.addRequestTokenUse=function(e){this.parameters.set(ae.REQUESTED_TOKEN_USE,encodeURIComponent(e))},Xt.prototype.addGrantType=function(e){this.parameters.set(ae.GRANT_TYPE,encodeURIComponent(e))},Xt.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},Xt.prototype.addExtraQueryParameters=function(t){var r=this;Jt.sanitizeEQParams(t,this.parameters),Object.keys(t).forEach(function(e){r.parameters.set(e,t[e])})},Xt.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(Z.isEmpty(e))r={};else try{r=JSON.parse(e)}catch(e){throw dt.createInvalidClaimsRequestError()}return t&&0<t.length&&(r.hasOwnProperty(ce.ACCESS_TOKEN)||(r[ce.ACCESS_TOKEN]={}),r[ce.ACCESS_TOKEN][ce.XMS_CC]={values:t}),JSON.stringify(r)},Xt.prototype.addUsername=function(e){this.parameters.set(Ue.username,e)},Xt.prototype.addPassword=function(e){this.parameters.set(Ue.password,e)},Xt.prototype.addPopToken=function(e){Z.isEmpty(e)||(this.parameters.set(ae.TOKEN_TYPE,y.AuthenticationScheme.POP),this.parameters.set(ae.REQ_CNF,encodeURIComponent(e)))},Xt.prototype.createQueryString=function(){var r=new Array;return this.parameters.forEach(function(e,t){r.push(t+"="+e)}),r.join("&")},Xt);function Xt(){this.parameters=new Map}var Zt=($t.extractTokenClaims=function(e,t){var r=Z.decodeAuthToken(e);if(!r)return null;try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw Q.createTokenParsingError(e)}},$t);function $t(e,t){if(Z.isEmpty(e))throw Q.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=$t.extractTokenClaims(e,t)}var er=(tr.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},tr.isTokenExpired=function(e,t){return(Number(e)||0)<tr.nowSeconds()+t},tr);function tr(){}var rr,nr=(t(or,rr=je),or.createIdTokenEntity=function(e,t,r,n,o,i){var a=new or;return a.credentialType=we.ID_TOKEN,a.homeAccountId=e,a.environment=t,a.clientId=n,a.secret=r,a.realm=o,a.oboAssertion=i,a},or.isIdTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===we.ID_TOKEN},or);function or(){return null!==rr&&rr.apply(this,arguments)||this}var ir,ar=(t(sr,ir=je),sr.createAccessTokenEntity=function(e,t,r,n,o,i,a,s,c,u){var h=new sr;h.homeAccountId=e,h.credentialType=we.ACCESS_TOKEN,h.secret=r;var d=er.nowSeconds();return h.cachedAt=d.toString(),h.expiresOn=a.toString(),h.extendedExpiresOn=s.toString(),h.environment=t,h.clientId=n,h.realm=o,h.target=i,h.oboAssertion=u,h.tokenType=Z.isEmpty(c)?y.AuthenticationScheme.BEARER:c,h},sr.isAccessTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&e.credentialType===we.ACCESS_TOKEN},sr);function sr(){return null!==ir&&ir.apply(this,arguments)||this}var cr,ur=(t(hr,cr=je),hr.createRefreshTokenEntity=function(e,t,r,n,o,i){var a=new hr;return a.clientId=n,a.credentialType=we.REFRESH_TOKEN,a.environment=t,a.homeAccountId=e,a.secret=r,a.oboAssertion=i,o&&(a.familyId=o),a},hr.isRefreshTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===we.REFRESH_TOKEN},hr);function hr(){return null!==cr&&cr.apply(this,arguments)||this}var dr,lr=["interaction_required","consent_required","login_required"],pr=["message_only","additional_action","basic_action","user_password_expired","consent_required"],fr=(t(yr,dr=xt),yr.isInteractionRequiredError=function(e,t,r){var n=!Z.isEmpty(e)&&-1<lr.indexOf(e),o=!Z.isEmpty(r)&&-1<pr.indexOf(r),i=!Z.isEmpty(t)&&lr.some(function(e){return-1<t.indexOf(e)});return n||i||o},yr);function yr(e,t,r){var n=dr.call(this,e,t,r)||this;return n.name="InteractionRequiredAuthError",Object.setPrototypeOf(n,yr.prototype),n}var gr,mr,Er=function(e,t,r,n,o){this.account=e,this.idToken=t,this.accessToken=r,this.refreshToken=n,this.appMetadata=o},vr=(Cr.setRequestState=function(e,t,r){var n=Cr.generateLibraryState(e,r);return Z.isEmpty(t)?n:""+n+he.RESOURCE_DELIM+t},Cr.generateLibraryState=function(e,t){if(!e)throw Q.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid(),ts:er.nowSeconds()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},Cr.parseRequestState=function(e,t){if(!e)throw Q.createNoCryptoObjectError("parseRequestState");if(Z.isEmpty(t))throw Q.createInvalidStateError(t,"Null, undefined or empty state");try{var r=decodeURIComponent(t).split(he.RESOURCE_DELIM),n=r[0],o=1<r.length?r.slice(1).join(he.RESOURCE_DELIM):"",i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:Z.isEmpty(o)?"":o,libraryState:a}}catch(e){throw Q.createInvalidStateError(t,e)}},Cr);function Cr(){}(mr=gr=gr||{}).SW="sw",mr.UHW="uhw";var Tr=(wr.prototype.generateCnf=function(n,o){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(n,o)];case 1:return t=e.sent(),r={kid:t,xms_ksl:gr.SW},[2,this.cryptoUtils.base64Encode(JSON.stringify(r))]}})})},wr.prototype.signPopToken=function(o,i,a){return m(this,void 0,void 0,function(){var t,r,n;return E(this,function(e){switch(e.label){case 0:return t=Zt.extractTokenClaims(o,this.cryptoUtils),r=new mt(a),n=r.getUrlComponents(),[4,this.cryptoUtils.signJwt({at:o,ts:""+er.nowSeconds(),m:i.toUpperCase(),u:n.HostNameAndPort||"",nonce:this.cryptoUtils.createNewGuid(),p:n.AbsolutePath,q:[[],n.QueryString]},t.cnf.kid)];case 1:return[2,e.sent()]}})})},wr);function wr(e){this.cryptoUtils=e}var Sr=(Ir.prototype.generateAppMetadataKey=function(){return Ir.generateAppMetadataCacheKey(this.environment,this.clientId)},Ir.generateAppMetadataCacheKey=function(e,t){return[ke,e,t].join(Ce.CACHE_KEY_SEPARATOR).toLowerCase()},Ir.createAppMetadataEntity=function(e,t,r){var n=new Ir;return n.clientId=e,n.environment=t,r&&(n.familyId=r),n},Ir.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf(ke)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},Ir);function Ir(){}var Ar=(Object.defineProperty(Rr.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!0,configurable:!0}),Object.defineProperty(Rr.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!0,configurable:!0}),Rr);function Rr(e,t){this.cache=e,this.hasChanged=t}var _r=(br.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw Q.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(fr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new fr(e.error,e.error_description,e.suberror);throw new xt(e.error,e.error_description,e.suberror)}e.client_info&&It(e.client_info,r)},br.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(fr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new fr(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new xt(e.error,t)}},br.prototype.handleServerTokenResponse=function(a,s,c,u,h,d,l,p,f){return m(this,void 0,void 0,function(){var t,r,n,o,i;return E(this,function(e){switch(e.label){case 0:if(t=null,!Z.isEmpty(a.id_token)&&(t=new Zt(a.id_token,this.cryptoObj),!Z.isEmpty(h)&&t.claims.nonce!==h))throw Q.createNonceMismatchError();this.homeAccountIdentifier=At.generateHomeAccountId(a.client_info,s.authorityType,this.logger,this.cryptoObj,t),r=null,Z.isEmpty(d)||(r=vr.parseRequestState(this.cryptoObj,d)),n=this.generateCacheRecord(a,t,s,r&&r.libraryState,l,p),e.label=1;case 1:return e.trys.push([1,,4,7]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),o=new Ar(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(o)]):[3,3];case 2:e.sent(),e.label=3;case 3:return f&&n.account&&(i=n.account.generateAccountKey(),!this.cacheStorage.getAccount(i))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,null]):(this.cacheStorage.saveCacheRecord(n),[3,7]);case 4:return this.persistencePlugin&&this.serializableCache&&o?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(o)]):[3,6];case 5:e.sent(),e.label=6;case 6:return[7];case 7:return[2,br.generateAuthenticationResult(this.cryptoObj,n,t,!1,r,c,u)]}})})},br.prototype.generateCacheRecord=function(e,t,r,n,o,i){var a=wt.generateEnvironmentFromAuthority(r);if(Z.isEmpty(a))throw Q.createInvalidCacheEnvironmentError();var s=null,c=null;Z.isEmpty(e.id_token)||(s=nr.createIdTokenEntity(this.homeAccountIdentifier,a,e.id_token,this.clientId,t.claims.tid||"",i),c=this.generateAccountEntity(e,t,r,i));var u=null;if(!Z.isEmpty(e.access_token)){var h=e.scope?yt.fromString(e.scope):new yt(o||[]),d=er.nowSeconds(),l=(n?n.ts:d)+e.expires_in,p=l+e.ext_expires_in;u=ar.createAccessTokenEntity(this.homeAccountIdentifier,a,e.access_token,this.clientId,t?t.claims.tid||"":r.tenant,h.printScopes(),l,p,e.token_type,i)}var f=null;Z.isEmpty(e.refresh_token)||(f=ur.createRefreshTokenEntity(this.homeAccountIdentifier,a,e.refresh_token,this.clientId,e.foci,i));var y=null;return Z.isEmpty(e.foci)||(y=Sr.createAppMetadataEntity(this.clientId,a,e.foci)),new Er(c,s,u,f,y)},br.prototype.generateAccountEntity=function(e,t,r,n){if(r.authorityType===pt.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),At.createGenericAccount(r,this.homeAccountIdentifier,t,n);if(Z.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw Q.createClientInfoEmptyError(e.client_info);return e.client_info?At.createAccount(e.client_info,this.homeAccountIdentifier,r,t,n):At.createGenericAccount(r,this.homeAccountIdentifier,t,n)},br.generateAuthenticationResult=function(c,u,h,d,l,p,f){return m(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return E(this,function(e){switch(e.label){case 0:return t="",r=[],i=o=n=null,u.accessToken?u.accessToken.tokenType!==y.AuthenticationScheme.POP?[3,2]:[4,new Tr(c).signPopToken(u.accessToken.secret,p,f)]:[3,4];case 1:return t=e.sent(),[3,3];case 2:t=u.accessToken.secret,e.label=3;case 3:r=yt.fromString(u.accessToken.target).asArray(),n=new Date(1e3*Number(u.accessToken.expiresOn)),o=new Date(1e3*Number(u.accessToken.extendedExpiresOn)),e.label=4;case 4:return u.appMetadata&&(i=u.appMetadata.familyId===Ne?Ne:null),a=h?h.claims.oid||h.claims.sub:"",s=h?h.claims.tid:"",[2,{uniqueId:a,tenantId:s,scopes:r,account:u.account?u.account.getAccountInfo():null,idToken:h?h.rawToken:"",idTokenClaims:h?h.claims:null,accessToken:t,fromCache:d,expiresOn:n,extExpiresOn:o,familyId:i,tokenType:u.accessToken?u.accessToken.tokenType:"",state:l?l.userRequestState:""}]}})})},br);function br(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i}var Or,kr=(t(Nr,Or=Wt),Nr.prototype.getAuthCodeUrl=function(r){return m(this,void 0,void 0,function(){var t;return E(this,function(e){return t=this.createAuthCodeUrlQueryString(r),[2,this.authority.authorizationEndpoint+"?"+t]})})},Nr.prototype.acquireToken=function(n,o,i){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:if(this.logger.info("in acquireToken call"),!n||Z.isEmpty(n.code))throw Q.createTokenRequestCannotBeMadeError();return[4,this.executeTokenRequest(this.authority,n)];case 1:return t=e.sent(),(r=new _r(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(t.body),[4,r.handleServerTokenResponse(t.body,this.authority,n.resourceRequestMethod,n.resourceRequestUri,o,i)];case 2:return[2,e.sent()]}})})},Nr.prototype.handleFragmentResponse=function(e,t){var r=new _r(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger),n=new mt(e),o=mt.getDeserializedHash(n.getHash());return r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),o.code},Nr.prototype.getLogoutUri=function(e){if(!e)throw dt.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(At.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=this.createLogoutUrlQueryString(e);return Z.isEmpty(t)?this.authority.endSessionEndpoint:this.authority.endSessionEndpoint+"?"+t},Nr.prototype.executeTokenRequest=function(o,i){return m(this,void 0,void 0,function(){var t,r,n;return E(this,function(e){switch(e.label){case 0:return t={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:i.scopes},[4,this.createTokenRequestBody(i)];case 1:return r=e.sent(),n=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(o.tokenEndpoint,r,n,t)]}})})},Nr.prototype.createTokenRequestBody=function(i){return m(this,void 0,void 0,function(){var t,r,n,o;return E(this,function(e){switch(e.label){case 0:return(t=new Qt).addClientId(this.config.authOptions.clientId),t.addRedirectUri(i.redirectUri),t.addScopes(i.scopes),t.addAuthorizationCode(i.code),i.codeVerifier&&t.addCodeVerifier(i.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(ge.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),i.authenticationScheme!==y.AuthenticationScheme.POP?[3,2]:[4,new Tr(this.cryptoUtils).generateCnf(i.resourceRequestMethod,i.resourceRequestUri)];case 1:n=e.sent(),t.addPopToken(n),e.label=2;case 2:return o=i.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),(!Z.isEmpty(i.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(i.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}})})},Nr.prototype.createAuthCodeUrlQueryString=function(e){var t=new Qt;t.addClientId(this.config.authOptions.clientId);var r=a(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.sid?t.addSid(e.sid):e.loginHint?t.addLoginHint(e.loginHint):e.account&&e.account.username&&t.addLoginHint(e.account.username),e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!Z.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},Nr.prototype.createLogoutUrlQueryString=function(e){var t=new Qt;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),t.createQueryString()},Nr);function Nr(e){return Or.call(this,e)||this}var Pr;t(Ur,Pr=Wt),Ur.prototype.acquireToken=function(o){return m(this,void 0,void 0,function(){var t,r,n;return E(this,function(e){switch(e.label){case 0:return[4,this.getDeviceCode(o)];case 1:return t=e.sent(),o.deviceCodeCallback(t),[4,this.acquireTokenWithDeviceCode(o,t)];case 2:return r=e.sent(),(n=new _r(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r),[4,n.handleServerTokenResponse(r,this.authority,o.resourceRequestMethod,o.resourceRequestUri)];case 3:return[2,e.sent()]}})})},Ur.prototype.getDeviceCode=function(o){return m(this,void 0,void 0,function(){var t,r,n;return E(this,function(e){return t=this.createQueryString(o),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:o.authority,scopes:o.scopes},[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,t,r,n)]})})},Ur.prototype.executePostRequestToDeviceCodeEndpoint=function(c,u,h,d){return m(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return E(this,function(e){switch(e.label){case 0:return[4,this.networkManager.sendPostRequest(d,c,{body:u,headers:h})];case 1:return t=e.sent().body,r=t.user_code,n=t.device_code,o=t.verification_uri,i=t.expires_in,a=t.interval,s=t.message,[2,{userCode:r,deviceCode:n,verificationUri:o,expiresIn:i,interval:a,message:s}]}})})},Ur.prototype.createQueryString=function(e){var t=new Qt;return t.addScopes(e.scopes),t.addClientId(this.config.authOptions.clientId),(!Z.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},Ur.prototype.acquireTokenWithDeviceCode=function(h,n){return m(this,void 0,void 0,function(){var s,c,u,t,r=this;return E(this,function(e){return s=this.createTokenRequestBody(h,n),c=this.createDefaultTokenRequestHeaders(),u=er.nowSeconds()+n.expiresIn,t=1e3*n.interval,[2,new Promise(function(o,i){var a=setInterval(function(){return m(r,void 0,void 0,function(){var t,r,n;return E(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),h.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(a),i(Q.createDeviceCodeCancelledError()),[3,4]):[3,1];case 1:return er.nowSeconds()>u?(this.logger.error("Device code expired. Expiration time of device code was "+u),clearInterval(a),i(Q.createDeviceCodeExpiredError()),[3,4]):[3,2];case 2:return t={clientId:this.config.authOptions.clientId,authority:h.authority,scopes:h.scopes},[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,s,c,t)];case 3:(r=e.sent()).body&&r.body.error==he.AUTHORIZATION_PENDING?this.logger.info(r.body.error_description):(clearInterval(a),o(r.body)),e.label=4;case 4:return[3,6];case 5:return n=e.sent(),clearInterval(a),i(n),[3,6];case 6:return[2]}})})},t)})]})})},Ur.prototype.createTokenRequestBody=function(e,t){var r=new Qt;r.addScopes(e.scopes),r.addClientId(this.config.authOptions.clientId),r.addGrantType(ge.DEVICE_CODE_GRANT),r.addDeviceCode(t.deviceCode);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return r.addCorrelationId(n),r.addClientInfo(),(!Z.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),r.createQueryString()};function Ur(e){return Pr.call(this,e)||this}var Lr,Mr=(t(Dr,Lr=Wt),Dr.prototype.acquireToken=function(n){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:return[4,this.executeTokenRequest(n,this.authority)];case 1:return t=e.sent(),(r=new _r(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(t.body),[2,r.handleServerTokenResponse(t.body,this.authority,n.resourceRequestMethod,n.resourceRequestUri,null,null,null,null,!0)]}})})},Dr.prototype.acquireTokenByRefreshToken=function(n){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){if(!n)throw dt.createEmptyTokenRequestError();if(!n.account)throw Q.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(n.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(n,!0)]}catch(e){if(t=e instanceof Q&&e.errorCode===_.code,r=e instanceof xt&&e.errorCode===Ke&&e.subError===xe,t||r)return[2,this.acquireTokenWithCachedRefreshToken(n,!1)];throw e}return[2,this.acquireTokenWithCachedRefreshToken(n,!1)]})})},Dr.prototype.acquireTokenWithCachedRefreshToken=function(n,o){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){if(!(t=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,n.account,o)))throw Q.createNoTokensFoundError();return r=l(l({},n),{refreshToken:t.secret,authenticationScheme:y.AuthenticationScheme.BEARER}),[2,this.acquireToken(r)]})})},Dr.prototype.executeTokenRequest=function(o,i){return m(this,void 0,void 0,function(){var t,r,n;return E(this,function(e){switch(e.label){case 0:return[4,this.createTokenRequestBody(o)];case 1:return t=e.sent(),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:i.canonicalAuthority,scopes:o.scopes},[2,this.executePostToTokenEndpoint(i.tokenEndpoint,t,r,n)]}})})},Dr.prototype.createTokenRequestBody=function(s){return m(this,void 0,void 0,function(){var t,r,n,o,i,a;return E(this,function(e){switch(e.label){case 0:return(t=new Qt).addClientId(this.config.authOptions.clientId),t.addScopes(s.scopes),t.addGrantType(ge.REFRESH_TOKEN_GRANT),t.addClientInfo(),r=s.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(s.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),s.authenticationScheme!==y.AuthenticationScheme.POP?[3,2]:(o=new Tr(this.cryptoUtils),a=(i=t).addPopToken,[4,o.generateCnf(s.resourceRequestMethod,s.resourceRequestUri)]);case 1:a.apply(i,[e.sent()]),e.label=2;case 2:return(!Z.isEmpty(s.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(s.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}})})},Dr);function Dr(e){return Lr.call(this,e)||this}var qr;t(Hr,qr=Wt),Hr.prototype.acquireToken=function(r){return m(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return this.scopeSet=new yt(r.scopes||[]),r.skipCache?[4,this.executeTokenRequest(r,this.authority)]:[3,2];case 1:return[2,e.sent()];case 2:return[4,this.getCachedAuthenticationResult()];case 3:return null==(t=e.sent())?[3,4]:[2,t];case 4:return[4,this.executeTokenRequest(r,this.authority)];case 5:return[2,e.sent()]}})})},Hr.prototype.getCachedAuthenticationResult=function(){return m(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return!(t=this.readAccessTokenFromCache())||er.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:[4,_r.generateAuthenticationResult(this.cryptoUtils,{account:null,accessToken:t,idToken:null,refreshToken:null,appMetadata:null},null,!0)];case 1:return[2,e.sent()]}})})},Hr.prototype.readAccessTokenFromCache=function(){var e={homeAccountId:"",environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:we.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase()},t=this.cacheManager.getCredentialsFilteredBy(e),r=Object.keys(t.accessTokens).map(function(e){return t.accessTokens[e]});if(r.length<1)return null;if(1<r.length)throw Q.createMultipleMatchingTokensInCacheError();return r[0]},Hr.prototype.executeTokenRequest=function(a,s){return m(this,void 0,void 0,function(){var t,r,n,o,i;return E(this,function(e){switch(e.label){case 0:return t=this.createTokenRequestBody(a),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:a.authority,scopes:a.scopes},[4,this.executePostToTokenEndpoint(s.tokenEndpoint,t,r,n)];case 1:return o=e.sent(),(i=new _r(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,a.resourceRequestMethod,a.resourceRequestUri,null,null,a.scopes)];case 2:return[2,e.sent()]}})})},Hr.prototype.createTokenRequestBody=function(e){var t=new Qt;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes,!1),t.addGrantType(ge.CLIENT_CREDENTIALS_GRANT);var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return(!Z.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()};function Hr(e){return qr.call(this,e)||this}var Kr;t(xr,Kr=Wt),xr.prototype.acquireToken=function(r){return m(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return this.scopeSet=new yt(r.scopes||[]),r.skipCache?[4,this.executeTokenRequest(r,this.authority)]:[3,2];case 1:return[2,e.sent()];case 2:return[4,this.getCachedAuthenticationResult(r)];case 3:return null==(t=e.sent())?[3,4]:[2,t];case 4:return[4,this.executeTokenRequest(r,this.authority)];case 5:return[2,e.sent()]}})})},xr.prototype.getCachedAuthenticationResult=function(s){return m(this,void 0,void 0,function(){var t,r,n,o,i,a;return E(this,function(e){switch(e.label){case 0:return!(t=this.readAccessTokenFromCache(s))||er.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:(r=this.readIdTokenFromCache(s),o=n=null,r&&(n=new Zt(r.secret,this.config.cryptoInterface),i=n.claims.oid?n.claims.oid:n.claims.sub,a={homeAccountId:r.homeAccountId,environment:r.environment,tenantId:r.realm,username:null,localAccountId:i},o=this.readAccountFromCache(a)),[4,_r.generateAuthenticationResult(this.cryptoUtils,{account:o,accessToken:t,idToken:r,refreshToken:null,appMetadata:null},n,!0)]);case 1:return[2,e.sent()]}})})},xr.prototype.readAccessTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:we.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase(),oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.accessTokens).map(function(e){return r.accessTokens[e]}),o=n.length;if(o<1)return null;if(1<o)throw Q.createMultipleMatchingTokensInCacheError();return n[0]},xr.prototype.readIdTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:we.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.idTokens).map(function(e){return r.idTokens[e]});return n.length<1?null:n[0]},xr.prototype.readAccountFromCache=function(e){return this.cacheManager.readAccountFromCache(e)},xr.prototype.executeTokenRequest=function(a,s){return m(this,void 0,void 0,function(){var t,r,n,o,i;return E(this,function(e){switch(e.label){case 0:return t=this.createTokenRequestBody(a),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:a.authority,scopes:a.scopes},[4,this.executePostToTokenEndpoint(s.tokenEndpoint,t,r,n)];case 1:return o=e.sent(),(i=new _r(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,a.resourceRequestMethod,a.resourceRequestUri,null,null,a.scopes,a.oboAssertion)];case 2:return[2,e.sent()]}})})},xr.prototype.createTokenRequestBody=function(e){var t=new Qt;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(ge.JWT_BEARER),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addRequestTokenUse(ae.ON_BEHALF_OF),t.addOboAssertion(e.oboAssertion),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return t.createQueryString()};function xr(e){return Kr.call(this,e)||this}var Fr,Gr=(t(Br,Fr=Wt),Br.prototype.acquireToken=function(r){return m(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.acquireCachedToken(r)];case 1:return[2,e.sent()];case 2:if((t=e.sent())instanceof Q&&t.errorCode===V.code)return[2,new Mr(this.config).acquireTokenByRefreshToken(r)];throw t;case 3:return[2]}})})},Br.prototype.acquireCachedToken=function(o){return m(this,void 0,void 0,function(){var t,r,n;return E(this,function(e){switch(e.label){case 0:if(!o)throw dt.createEmptyTokenRequestError();if(!o.account)throw Q.createNoAccountInSilentRequestError();if(t=new yt(o.scopes||[]),r=o.authority||wt.generateEnvironmentFromAuthority(this.authority),n=this.cacheManager.readCacheRecord(o.account,this.config.authOptions.clientId,t,r),!this.isRefreshRequired(o,n.accessToken))return[3,1];throw Q.createRefreshRequiredError();case 1:return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(n,o.resourceRequestMethod,o.resourceRequestUri)];case 2:return[2,e.sent()]}})})},Br.prototype.generateResultFromCacheRecord=function(r,n,o){return m(this,void 0,void 0,function(){var t;return E(this,function(e){switch(e.label){case 0:return t=new Zt(r.idToken.secret,this.config.cryptoInterface),[4,_r.generateAuthenticationResult(this.cryptoUtils,r,t,!0,null,n,o)];case 1:return[2,e.sent()]}})})},Br.prototype.isRefreshRequired=function(e,t){return!(!e.forceRefresh&&!e.claims&&t&&!er.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))},Br);function Br(e){return Fr.call(this,e)||this}var jr;t(zr,jr=Wt),zr.prototype.acquireToken=function(n){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:return this.logger.info("in acquireToken call"),[4,this.executeTokenRequest(this.authority,n)];case 1:return t=e.sent(),(r=new _r(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(t.body),[2,r.handleServerTokenResponse(t.body,this.authority)]}})})},zr.prototype.executeTokenRequest=function(o,i){return m(this,void 0,void 0,function(){var t,r,n;return E(this,function(e){switch(e.label){case 0:return t={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:i.scopes},[4,this.createTokenRequestBody(i)];case 1:return r=e.sent(),n=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(o.tokenEndpoint,r,n,t)]}})})},zr.prototype.createTokenRequestBody=function(e){var t=new Qt;t.addClientId(this.config.authOptions.clientId),t.addUsername(e.username),t.addPassword(e.password),t.addScopes(e.scopes),t.addGrantType(ge.RESOURCE_OWNER_PASSWORD_GRANT),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(r),(!Z.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()};function zr(e){return jr.call(this,e)||this}var Wr=(Yr.createDiscoveredInstance=function(n,o,i){return m(this,void 0,void 0,function(){var t,r;return E(this,function(e){switch(e.label){case 0:if((t=Yr.createInstance(n,o,i)).discoveryComplete())return[2,t];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.resolveEndpointsAsync()];case 2:return e.sent(),[2,t];case 3:throw r=e.sent(),Q.createEndpointDiscoveryIncompleteError(r);case 4:return[2]}})})},Yr.createInstance=function(e,t,r){if(Z.isEmpty(e))throw dt.createUrlEmptyError();return new wt(e,t,r)},Yr);function Yr(){}var Jr=(Vr.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(Pe.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},Vr);function Vr(){this.failedRequests=[],this.errors=[],this.cacheHits=0}var Qr=(Xr.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(He));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},Xr);function Xr(){}var Zr=($r.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+Pe.VALUE_SEPARATOR+e;return[Pe.SCHEMA_VERSION,t,""].join(Pe.CATEGORY_SEPARATOR)},$r.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=$r.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(Pe.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(Pe.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?Pe.OVERFLOW_TRUE:Pe.OVERFLOW_FALSE].join(Pe.VALUE_SEPARATOR);return[Pe.SCHEMA_VERSION,e.cacheHits,r,n,i].join(Pe.CATEGORY_SEPARATOR)},$r.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.failedRequests.push(this.apiId,this.correlationId),Z.isEmpty(e.suberror)?Z.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Pe.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.suberror),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},$r.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},$r.prototype.getLastRequests=function(){var e=new Jr;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},$r.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=$r.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var r=new Jr;r.failedRequests=e.failedRequests.slice(2*t),r.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}},$r.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||he.EMPTY_STRING,a=e.failedRequests[2*t+1]||he.EMPTY_STRING,s=e.errors[t]||he.EMPTY_STRING;if(!((n+=i.toString().length+a.toString().length+s.length+3)<Pe.MAX_HEADER_BYTES))break;r+=1}return r},$r);function $r(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.telemetryCacheKey=Pe.CACHE_KEY+Ce.CACHE_KEY_SEPARATOR+e.clientId}var en,tn,rn,nn,on,an,sn,cn,un="interaction.status",hn="interaction_in_progress",dn="invalid_grant",ln=483,pn=600,fn=50,yn="msal.js.browser";(en=y.BrowserCacheLocation||(y.BrowserCacheLocation={})).LocalStorage="localStorage",en.SessionStorage="sessionStorage",en.MemoryStorage="memoryStorage",(rn=tn=tn||{}).GET="GET",rn.POST="POST",(on=nn=nn||{}).AUTHORITY="authority",on.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",on.SESSION_STATE="session.state",on.REQUEST_STATE="request.state",on.NONCE_IDTOKEN="nonce.id_token",on.ORIGIN_URI="request.origin",on.RENEW_STATUS="token.renew.status",on.URL_HASH="urlHash",on.REQUEST_PARAMS="request.params",on.SCOPES="scopes",(sn=an=an||{})[sn.acquireTokenRedirect=861]="acquireTokenRedirect",sn[sn.acquireTokenPopup=862]="acquireTokenPopup",sn[sn.ssoSilent=863]="ssoSilent",sn[sn.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",sn[sn.handleRedirectPromise=865]="handleRedirectPromise",sn[sn.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",(cn=y.InteractionType||(y.InteractionType={})).Redirect="redirect",cn.Popup="popup",cn.Silent="silent";var gn={scopes:[he.OPENID_SCOPE,he.PROFILE_SCOPE]},mn="jwk",En=(vn.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},vn);function vn(){}var Cn=(Tn.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,En.decimalToHex(e[0])+En.decimalToHex(e[1])+En.decimalToHex(e[2])+En.decimalToHex(e[3])+"-"+En.decimalToHex(e[4])+En.decimalToHex(e[5])+"-"+En.decimalToHex(e[6])+En.decimalToHex(e[7])+"-"+En.decimalToHex(e[8])+En.decimalToHex(e[9])+"-"+En.decimalToHex(e[10])+En.decimalToHex(e[11])+En.decimalToHex(e[12])+En.decimalToHex(e[13])+En.decimalToHex(e[14])+En.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},Tn.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},Tn);function Tn(e){this.cryptoObj=e}var wn=(Sn.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?i[a++]=t:(t<2048?i[a++]=192+(t>>>6):(t<65536?i[a++]=224+(t>>>12):(t<2097152?i[a++]=240+(t>>>18):(t<67108864?i[a++]=248+(t>>>24):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63)),i[a++]=128+(t>>>18&63)),i[a++]=128+(t>>>12&63)),i[a++]=128+(t>>>6&63)),i[a++]=128+(63&t));return i},Sn.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},Sn.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(251<r&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:247<r&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:239<r&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:223<r&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:191<r&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},Sn);function Sn(){}var In=(An.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},An.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},An.prototype.encode=function(e){var t=wn.stringToUtf8Arr(e);return this.base64EncArr(t)},An.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0==t?r:r.substring(0,r.length-t)+(1==t?"=":"==")},An.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},An);function An(){}var Rn=(_n.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return wn.utf8ArrToString(r)},_n.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,u=0,h=0;h<n;h++)if(s=3&h,c|=this.b64ToUint6(r.charCodeAt(h))<<18-6*s,3===s||n-h==1){for(a=0;a<3&&u<o;a++,u++)i[u]=c>>>(16>>>a&24)&255;c=0}return i},_n.prototype.b64ToUint6=function(e){return 64<e&&e<91?e-65:96<e&&e<123?e-71:47<e&&e<58?e+4:43===e?62:47===e?63:0},_n);function _n(){}var bn,On={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentSSOInsufficientInfoError:{code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},tokenRequestCacheError:{code:"token_request_cache_error",desc:"The token request could not be fetched from the cache correctly."},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."}},kn=(e(Nn,bn=c),Nn.createPkceNotGeneratedError=function(e){return new Nn(On.pkceNotGenerated.code,On.pkceNotGenerated.desc+" Detail:"+e)},Nn.createCryptoNotAvailableError=function(e){return new Nn(On.cryptoDoesNotExist.code,On.cryptoDoesNotExist.desc+" Detail:"+e)},Nn.createHttpMethodNotImplementedError=function(e){return new Nn(On.httpMethodNotImplementedError.code,On.httpMethodNotImplementedError.desc+" Given Method: "+e)},Nn.createEmptyNavigationUriError=function(){return new Nn(On.emptyNavigateUriError.code,On.emptyNavigateUriError.desc)},Nn.createEmptyHashError=function(e){return new Nn(On.hashEmptyError.code,On.hashEmptyError.desc+" Given Url: "+e)},Nn.createInteractionInProgressError=function(){return new Nn(On.interactionInProgress.code,On.interactionInProgress.desc)},Nn.createPopupWindowError=function(e){var t=On.popUpWindowError.desc;return t=Z.isEmpty(e)?t:t+" Details: "+e,new Nn(On.popUpWindowError.code,t)},Nn.createEmptyWindowCreatedError=function(){return new Nn(On.emptyWindowError.code,On.emptyWindowError.desc)},Nn.createUserCancelledError=function(){return new Nn(On.userCancelledError.code,On.userCancelledError.desc)},Nn.createMonitorPopupTimeoutError=function(){return new Nn(On.monitorPopupTimeoutError.code,On.monitorPopupTimeoutError.desc)},Nn.createMonitorIframeTimeoutError=function(){return new Nn(On.monitorIframeTimeoutError.code,On.monitorIframeTimeoutError.desc)},Nn.createRedirectInIframeError=function(e){return new Nn(On.redirectInIframeError.code,On.redirectInIframeError.desc+" (window.parent !== window) => "+e)},Nn.createBlockReloadInHiddenIframeError=function(){return new Nn(On.blockTokenRequestsInHiddenIframeError.code,On.blockTokenRequestsInHiddenIframeError.desc)},Nn.createIframeClosedPrematurelyError=function(){return new Nn(On.iframeClosedPrematurelyError.code,On.iframeClosedPrematurelyError.desc)},Nn.createSilentSSOInsufficientInfoError=function(){return new Nn(On.silentSSOInsufficientInfoError.code,On.silentSSOInsufficientInfoError.desc)},Nn.createSilentPromptValueError=function(e){return new Nn(On.silentPromptValueError.code,On.silentPromptValueError.desc+" Given value: "+e)},Nn.createTokenRequestCacheError=function(e){return new Nn(On.tokenRequestCacheError.code,On.tokenRequestCacheError.desc+" Error Detail: "+e)},Nn.createInvalidCacheTypeError=function(){return new Nn(On.invalidCacheType.code,""+On.invalidCacheType.desc)},Nn.createNonBrowserEnvironmentError=function(){return new Nn(On.notInBrowserEnvironment.code,On.notInBrowserEnvironment.desc)},Nn);function Nn(e,t){var r=bn.call(this,e,t)||this;return Object.setPrototypeOf(r,Nn.prototype),r.name="BrowserAuthError",r}var Pn=(Un.prototype.generateCodes=function(){return f(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return r=e.sent(),[2,{verifier:t,challenge:r}]}})})},Un.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw kn.createPkceNotGeneratedError(e)}},Un.prototype.generateCodeChallengeFromVerifier=function(n){return f(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(n)];case 1:return t=e.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=e.sent(),kn.createPkceNotGeneratedError(r);case 3:return[2]}})})},Un);function Un(e){this.base64Encode=new In,this.cryptoObj=e}var Ln="SHA-256",Mn=new Uint8Array([1,0,1]),Dn=(qn.prototype.sha256Digest=function(r){return f(this,void 0,void 0,function(){var t;return g(this,function(e){return t=wn.stringToUtf8Arr(r),[2,this.hasIECrypto()?this.getMSCryptoDigest(Ln,t):this.getSubtleCryptoDigest(Ln,t)]})})},qn.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw kn.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},qn.prototype.generateKeyPair=function(t,r){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(t,r):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,t,r)]})})},qn.prototype.exportJwk=function(t){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,this.hasIECrypto()?this.msCryptoExportJwk(t):window.crypto.subtle.exportKey(mn,t)]})})},qn.prototype.importJwk=function(n,o,i){return f(this,void 0,void 0,function(){var t,r;return g(this,function(e){return t=qn.getJwkString(n),r=wn.stringToArrayBuffer(t),[2,this.hasIECrypto()?this.msCryptoImportKey(r,o,i):window.crypto.subtle.importKey(mn,n,this._keygenAlgorithmOptions,o,i)]})})},qn.prototype.sign=function(t,r){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,this.hasIECrypto()?this.msCryptoSign(t,r):window.crypto.subtle.sign(this._keygenAlgorithmOptions,t,r)]})})},qn.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},qn.prototype.hasIECrypto=function(){return"msCrypto"in window},qn.prototype.hasBrowserCrypto=function(){return"crypto"in window},qn.prototype.getSubtleCryptoDigest=function(t,r){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,window.crypto.subtle.digest(t,r)]})})},qn.prototype.getMSCryptoDigest=function(n,o){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.digest(n,o.buffer);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},qn.prototype.msCryptoGenerateKey=function(o,i){return f(this,void 0,void 0,function(){var n=this;return g(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.generateKey(n._keygenAlgorithmOptions,o,i);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},qn.prototype.msCryptoExportJwk=function(t){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,new Promise(function(n,o){var e=window.msCrypto.subtle.exportKey(mn,t);e.addEventListener("complete",function(e){var t=e.target.result,r=wn.utf8ArrToString(new Uint8Array(t)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{n(JSON.parse(r))}catch(e){o(e)}}),e.addEventListener("error",function(e){o(e)})})]})})},qn.prototype.msCryptoImportKey=function(o,i,a){return f(this,void 0,void 0,function(){var n=this;return g(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.importKey(mn,o,n._keygenAlgorithmOptions,i,a);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},qn.prototype.msCryptoSign=function(o,i){return f(this,void 0,void 0,function(){var n=this;return g(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.sign(n._keygenAlgorithmOptions,o,i);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},qn.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},qn);function qn(){if(!this.hasCryptoAPI())throw kn.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Ln,modulusLength:2048,publicExponent:Mn}}var Hn=(Kn.prototype.open=function(){return f(this,void 0,void 0,function(){var n=this;return g(this,function(e){return[2,new Promise(function(t,r){var e=window.indexedDB.open(n.dbName,n.version);e.addEventListener("upgradeneeded",function(e){e.target.result.createObjectStore(n.tableName)}),e.addEventListener("success",function(e){n.db=e.target.result,n.dbOpen=!0,t()}),e.addEventListener("error",function(e){return r(e)})})]})})},Kn.prototype.get=function(o){return f(this,void 0,void 0,function(){var n=this;return g(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:e.sent(),e.label=2;case 2:return[2,new Promise(function(t,r){var e=n.db.transaction([n.tableName],"readonly").objectStore(n.tableName).get(o);e.addEventListener("success",function(e){return t(e.target.result)}),e.addEventListener("error",function(e){return r(e)})})]}})})},Kn.prototype.put=function(o,i){return f(this,void 0,void 0,function(){var n=this;return g(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:e.sent(),e.label=2;case 2:return[2,new Promise(function(t,r){var e=n.db.transaction([n.tableName],"readwrite").objectStore(n.tableName).put(i,o);e.addEventListener("success",function(e){return t(e.target.result)}),e.addEventListener("error",function(e){return r(e)})})]}})})},Kn);function Kn(e,t,r){this.dbName=e,this.tableName=t,this.version=r,this.dbOpen=!1}var xn=(Fn.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},Fn.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},Fn.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},Fn.prototype.generatePkceCodes=function(){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},Fn.prototype.getPublicKeyThumbprint=function(u,h){return f(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c;return g(this,function(e){switch(e.label){case 0:return[4,this.browserCrypto.generateKeyPair(Fn.EXTRACTABLE,Fn.POP_KEY_USAGES)];case 1:return t=e.sent(),[4,this.browserCrypto.exportJwk(t.publicKey)];case 2:return r=e.sent(),n={e:r.e,kty:r.kty,n:r.n},o=Dn.getJwkString(n),[4,this.browserCrypto.sha256Digest(o)];case 3:return i=e.sent(),a=this.b64Encode.urlEncodeArr(new Uint8Array(i)),[4,this.browserCrypto.exportJwk(t.privateKey)];case 4:return s=e.sent(),[4,this.browserCrypto.importJwk(s,!1,["sign"])];case 5:return c=e.sent(),this.cache.put(a,{privateKey:c,publicKey:t.publicKey,requestMethod:u,requestUri:h}),[2,a]}})})},Fn.prototype.signJwt=function(d,l){return f(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c,u,h;return g(this,function(e){switch(e.label){case 0:return[4,this.cache.get(l)];case 1:return t=e.sent(),[4,this.browserCrypto.exportJwk(t.publicKey)];case 2:return r=e.sent(),n=Dn.getJwkString(r),o={alg:r.alg,type:mn},i=this.b64Encode.urlEncode(JSON.stringify(o)),d.cnf={jwk:JSON.parse(n)},a=this.b64Encode.urlEncode(JSON.stringify(d)),s=i+"."+a,c=wn.stringToArrayBuffer(s),[4,this.browserCrypto.sign(t.privateKey,c)];case 3:return u=e.sent(),h=this.b64Encode.urlEncodeArr(new Uint8Array(u)),[2,s+"."+h]}})})},Fn.POP_KEY_USAGES=["sign","verify"],Fn.EXTRACTABLE=!0,Fn.DB_VERSION=1,Fn.TABLE_NAME=(Fn.DB_NAME="msal.db")+".keys",Fn);function Fn(){this.browserCrypto=new Dn,this.b64Encode=new In,this.b64Decode=new Rn,this.guidGenerator=new Cn(this.browserCrypto),this.pkceGenerator=new Pn(this.browserCrypto),this.cache=new Hn(Fn.DB_NAME,Fn.TABLE_NAME,Fn.DB_VERSION)}var Gn,Bn={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider."},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."}},jn=(e(zn,Gn=c),zn.createRedirectUriEmptyError=function(){return new zn(Bn.redirectUriNotSet.code,Bn.redirectUriNotSet.desc)},zn.createPostLogoutRedirectUriEmptyError=function(){return new zn(Bn.postLogoutUriNotSet.code,Bn.postLogoutUriNotSet.desc)},zn.createStorageNotSupportedError=function(e){return new zn(Bn.storageNotSupportedError.code,Bn.storageNotSupportedError.desc+" Given Location: "+e)},zn.createInvalidCallbackObjectError=function(e){return new zn(Bn.invalidCallbackObject.code,Bn.invalidCallbackObject.desc+" Given value for callback function: "+e)},zn.createRedirectCallbacksNotSetError=function(){return new zn(Bn.noRedirectCallbacksSet.code,Bn.noRedirectCallbacksSet.desc)},zn.createStubPcaInstanceCalledError=function(){return new zn(Bn.stubPcaInstanceCalled.code,Bn.stubPcaInstanceCalled.desc)},zn.createInMemoryRedirectUnavailableError=function(){return new zn(Bn.inMemRedirectUnavailable.code,Bn.inMemRedirectUnavailable.desc)},zn);function zn(e,t){var r=Gn.call(this,e,t)||this;return r.name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,zn.prototype),r}var Wn=(Object.defineProperty(Yn.prototype,"windowStorage",{get:function(){return this._windowStorage||(this._windowStorage=window[this.cacheLocation]),this._windowStorage},enumerable:!0,configurable:!0}),Yn.prototype.validateWindowStorage=function(e){if(e!==y.BrowserCacheLocation.LocalStorage&&e!==y.BrowserCacheLocation.SessionStorage)throw jn.createStorageNotSupportedError(e);if(!window[e])throw jn.createStorageNotSupportedError(e)},Yn.prototype.getItem=function(e){return this.windowStorage.getItem(e)},Yn.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},Yn.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},Yn.prototype.getKeys=function(){return Object.keys(this.windowStorage)},Yn.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},Yn);function Yn(e){this.validateWindowStorage(e),this.cacheLocation=e}var Jn=(Vn.prototype.getItem=function(e){return this.cache.get(e)||null},Vn.prototype.setItem=function(e,t){this.cache.set(e,t)},Vn.prototype.removeItem=function(e){this.cache.delete(e)},Vn.prototype.getKeys=function(){var r=[];return this.cache.forEach(function(e,t){r.push(t)}),r},Vn.prototype.containsKey=function(e){return this.cache.has(e)},Vn);function Vn(){this.cache=new Map}var Qn,Xn=(e(Zn,Qn=_t),Zn.prototype.setupBrowserStorage=function(e){switch(e){case y.BrowserCacheLocation.LocalStorage:case y.BrowserCacheLocation.SessionStorage:try{return new Wn(e)}catch(e){return this.logger.verbose(e),this.cacheConfig.cacheLocation=y.BrowserCacheLocation.MemoryStorage,new Jn}case y.BrowserCacheLocation.MemoryStorage:default:return new Jn}},Zn.prototype.migrateCacheEntries=function(){var r=this,e=he.CACHE_PREFIX+"."+re.ID_TOKEN,t=he.CACHE_PREFIX+"."+re.CLIENT_INFO,n=he.CACHE_PREFIX+"."+re.ERROR,o=he.CACHE_PREFIX+"."+re.ERROR_DESC,i=[this.browserStorage.getItem(e),this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[re.ID_TOKEN,re.CLIENT_INFO,re.ERROR,re.ERROR_DESC].forEach(function(e,t){return r.migrateCacheEntry(e,i[t])})},Zn.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},Zn.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},Zn.prototype.getItem=function(e){return this.browserStorage.getItem(e)},Zn.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},Zn.prototype.getAccount=function(e){var t=this.getItem(e);if(Z.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=_t.toObject(new At,r);return At.isAccountEntity(n)?n:null},Zn.prototype.setAccount=function(e){var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},Zn.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(Z.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=_t.toObject(new nr,r);return nr.isIdTokenEntity(n)?n:null},Zn.prototype.setIdTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},Zn.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(Z.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=_t.toObject(new ar,r);return ar.isAccessTokenEntity(n)?n:null},Zn.prototype.setAccessTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},Zn.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(Z.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=_t.toObject(new ur,r);return ur.isRefreshTokenEntity(n)?n:null},Zn.prototype.setRefreshTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},Zn.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(Z.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=_t.toObject(new Sr,r);return Sr.isAppMetadataEntity(e,n)?n:null},Zn.prototype.setAppMetadata=function(e){var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},Zn.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(Z.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=_t.toObject(new Jr,r);return Jr.isServerTelemetryEntity(e,n)?n:null},Zn.prototype.setServerTelemetry=function(e,t){this.setItem(e,JSON.stringify(t))},Zn.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(Z.isEmpty(t))return null;var r=this.validateAndParseJson(t),n=_t.toObject(new Qr,r);return Qr.isThrottlingEntity(e,n)?n:null},Zn.prototype.setThrottlingCache=function(e,t){this.setItem(e,JSON.stringify(t))},Zn.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return n}var o=this.getItem(r);return Z.isEmpty(o)?null:o},Zn.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(n,t)},Zn.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(e),!0},Zn.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)},Zn.prototype.getKeys=function(){return this.browserStorage.getKeys()},Zn.prototype.clear=function(){var t=this;this.removeAllAccounts(),this.removeAppMetadata(),this.browserStorage.getKeys().forEach(function(e){!t.browserStorage.containsKey(e)||-1===e.indexOf(he.CACHE_PREFIX)&&-1===e.indexOf(t.clientId)||t.removeItem(e)})},Zn.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},Zn.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},Zn.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},Zn.prototype.clearMsalCookie=function(e){var t=e?this.generateNonceKey(e):this.generateStateKey(nn.NONCE_IDTOKEN);this.clearItemCookie(this.generateStateKey(e)),this.clearItemCookie(t),this.clearItemCookie(this.generateCacheKey(nn.ORIGIN_URI))},Zn.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},Zn.prototype.getCache=function(){return this.browserStorage},Zn.prototype.setCache=function(){},Zn.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):Z.startsWith(e,he.CACHE_PREFIX)||Z.startsWith(e,re.ADAL_ID_TOKEN)?e:he.CACHE_PREFIX+"."+this.clientId+"."+e},Zn.prototype.generateAuthorityKey=function(e){var t=vr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(nn.AUTHORITY+"."+t)},Zn.prototype.generateNonceKey=function(e){var t=vr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(nn.NONCE_IDTOKEN+"."+t)},Zn.prototype.generateStateKey=function(e){var t=vr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(nn.REQUEST_STATE+"."+t)},Zn.prototype.setAuthorityCache=function(e,t){var r=this.generateAuthorityKey(t);this.setItem(r,e)},Zn.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},Zn.prototype.updateCacheEntries=function(e,t,r){var n=this.generateStateKey(e);this.setTemporaryCache(n,e,!1);var o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1),this.setAuthorityCache(r,e)},Zn.prototype.resetRequestCache=function(t){var r=this;this.getKeys().forEach(function(e){Z.isEmpty(t)||-1===e.indexOf(t)||r.removeItem(e)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(nn.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(nn.ORIGIN_URI)),this.removeItem(this.generateCacheKey(nn.URL_HASH))},Zn.prototype.cleanRequest=function(e){if(this.removeItem(this.generateCacheKey(un)),e){var t=this.generateStateKey(e),r=this.getItem(t);this.resetRequestCache(r||"")}},Zn.prototype.cacheCodeRequest=function(e,t){var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(nn.REQUEST_PARAMS,r,!0)},Zn.prototype.getCachedRequest=function(e,t){try{var r=this.getTemporaryCache(nn.REQUEST_PARAMS,!0),n=JSON.parse(t.base64Decode(r));if(this.removeItem(this.generateCacheKey(nn.REQUEST_PARAMS)),Z.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);n.authority=i}return n}catch(e){throw kn.createTokenRequestCacheError(e)}},Zn);function Zn(e,t,r,n){var o=Qn.call(this)||this;return o.COOKIE_LIFE_MULTIPLIER=864e5,o.cacheConfig=t,o.clientId=e,o.cryptoImpl=r,o.logger=n,o.browserStorage=o.setupBrowserStorage(t.cacheLocation),o.migrateCacheEntries(),o}var $n=(eo.prototype.sendGetRequestAsync=function(n,o){return f(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return[4,fetch(n,{method:tn.GET,headers:this.getFetchHeaders(o)})];case 1:return t=e.sent(),r={headers:this.getHeaderDict(t.headers)},[4,t.json()];case 2:return[2,(r.body=e.sent(),r.status=t.status,r)]}})})},eo.prototype.sendPostRequestAsync=function(o,i){return f(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return t=i&&i.body||"",[4,fetch(o,{method:tn.POST,headers:this.getFetchHeaders(i),body:t})];case 1:return r=e.sent(),n={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 2:return[2,(n.body=e.sent(),n.status=r.status,n)]}})})},eo.prototype.getFetchHeaders=function(t){var r=new Headers;return t&&t.headers&&Object.keys(t.headers).forEach(function(e){r.append(e,t.headers[e])}),r},eo.prototype.getHeaderDict=function(e){var r={};return e.forEach(function(e,t){r[t]=e}),r},eo);function eo(){}var to=(ro.prototype.sendGetRequestAsync=function(t,r){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,this.sendRequestAsync(t,tn.GET,r)]})})},ro.prototype.sendPostRequestAsync=function(t,r){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,this.sendRequestAsync(t,tn.POST,r)]})})},ro.prototype.sendRequestAsync=function(e,t,i){var a=this;return new Promise(function(r,n){var o=new XMLHttpRequest;if(o.open(t,e,!0),a.setXhrHeaders(o,i),o.onload=function(){(o.status<200||300<=o.status)&&n(o.responseText);try{var e=JSON.parse(o.responseText),t={headers:a.getHeaderDict(o),body:e,status:o.status};r(t)}catch(e){n(o.responseText)}},o.onerror=function(){n(o.status)},"POST"===t&&i.body)o.send(i.body);else{if("GET"!==t)throw kn.createHttpMethodNotImplementedError(t);o.send()}})},ro.prototype.setXhrHeaders=function(t,r){r&&r.headers&&Object.keys(r.headers).forEach(function(e){t.setRequestHeader(e,r.headers[e])})},ro.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),o={};return t.forEach(function(e){var t=e.split(": "),r=t.shift(),n=t.join(": ");o[r]=n}),o},ro);function ro(){}var no=(oo.navigateWindow=function(e,t,r,n){return n?window.location.replace(e):window.location.assign(e),new Promise(function(e){setTimeout(function(){r.warning("Expected to navigate away from the current page but timeout occurred."),e()},t)})},oo.clearHash=function(){"function"==typeof history.replaceState?history.replaceState(null,null,""+window.location.pathname+window.location.search):window.location.hash=""},oo.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=0<t.length?t.join("#"):""},oo.isInIframe=function(){return window.parent!==window},oo.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},oo.getHomepage=function(){var e=new mt(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},oo.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new $n:new to},oo.blockReloadInHiddenIframes=function(){if(mt.hashContainsKnownProperties(window.location.hash)&&oo.isInIframe())throw kn.createBlockReloadInHiddenIframeError()},oo.blockNonBrowserEnvironment=function(e){if(!e)throw kn.createNonBrowserEnvironmentError()},oo.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return 0<t||0<r||0<n},oo);function oo(){}var io=6e4,ao=6e3,so=3e4;var co=(uo.extractBrowserRequestState=function(e,t){if(Z.isEmpty(t))return null;try{return vr.parseRequestState(e,t).libraryState.meta}catch(e){throw Q.createInvalidStateError(t,e)}},uo.parseServerResponseFromHash=function(e){if(!e)return{};var t=new mt(e);return mt.getDeserializedHash(t.getHash())},uo);function uo(){}var ho=(lo.prototype.initiateAuthRequest=function(e,t,r,n,o){if(Z.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),kn.createEmptyNavigationUriError();n&&this.browserStorage.setTemporaryCache(nn.ORIGIN_URI,n,!0),this.browserStorage.setTemporaryCache(un,hn,!0),this.browserStorage.cacheCodeRequest(t,this.browserCrypto),this.authModule.logger.infoPii("Navigate to:"+e);var i=no.isInIframe();if(i)throw kn.createRedirectInIframeError(i);return"function"!=typeof o?(this.authModule.logger.verbose("Navigating window to navigate url"),no.navigateWindow(e,r,this.authModule.logger)):(this.authModule.logger.verbose("Invoking onRedirectNavigate callback"),!1!==o(e)?(this.authModule.logger.verbose("onRedirectNavigate did not return false, navigating"),no.navigateWindow(e,r,this.authModule.logger)):(this.authModule.logger.verbose("onRedirectNavigate returned false, stopping navigation"),Promise.resolve()))},lo.prototype.handleCodeResponse=function(c,u){return f(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return g(this,function(e){switch(e.label){case 0:if(Z.isEmpty(c))throw kn.createEmptyHashError(c);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(un)),t=co.parseServerResponseFromHash(c),r=this.browserStorage.generateStateKey(t.state),n=this.browserStorage.getTemporaryCache(r),o=this.authModule.handleFragmentResponse(c,n),i=this.browserStorage.generateNonceKey(n),a=this.browserStorage.getTemporaryCache(i),this.authCodeRequest=this.browserStorage.getCachedRequest(n,this.browserCrypto),this.authCodeRequest.code=o,u&&Gt.removeThrottle(this.browserStorage,u,this.authCodeRequest.authority,this.authCodeRequest.scopes),[4,this.authModule.acquireToken(this.authCodeRequest,a,n)];case 1:return s=e.sent(),this.browserStorage.cleanRequest(t.state),[2,s]}})})},lo);function lo(e,t,r){this.authModule=e,this.browserStorage=t,this.browserCrypto=r}var po=(fo.prototype.handleCodeResponse=function(c){return f(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return g(this,function(e){switch(e.label){case 0:if(Z.isEmpty(c))throw kn.createEmptyHashError(c);return t=co.parseServerResponseFromHash(c),r=this.browserStorage.generateStateKey(t.state),n=this.browserStorage.getTemporaryCache(r),o=this.authModule.handleFragmentResponse(c,n),i=this.browserStorage.generateNonceKey(n),a=this.browserStorage.getTemporaryCache(i),this.authCodeRequest.code=o,[4,this.authModule.acquireToken(this.authCodeRequest,a,n)];case 1:return s=e.sent(),this.browserStorage.cleanRequest(t.state),[2,s]}})})},fo);function fo(e,t){this.authModule=e,this.browserStorage=t}var yo,go=(e(mo,yo=po),mo.prototype.initiateAuthRequest=function(e,t,r){if(Z.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),kn.createEmptyNavigationUriError();return this.authCodeRequest=t,this.browserStorage.setTemporaryCache(un,hn,!0),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,r)},mo.prototype.monitorPopupForHash=function(s,e){var c=this;return new Promise(function(r,n){e<io&&c.authModule.logger.warning("system.loadFrameTimeout or system.windowHashTimeout set to lower ("+e+"ms) than the default ("+io+"ms). This may result in timeouts.");var o=e/fn,i=0,a=setInterval(function(){if(s.closed)return c.cleanPopup(),clearInterval(a),void n(kn.createUserCancelledError());var e;try{e=s.location.href}catch(e){}if(!Z.isEmpty(e)&&"about:blank"!==e){i++;var t=s.location.hash;return mt.hashContainsKnownProperties(t)?(c.cleanPopup(s),clearInterval(a),void r(t)):o<i?(c.cleanPopup(s),clearInterval(a),void n(kn.createMonitorPopupTimeoutError())):void 0}},fn)})},mo.prototype.openPopup=function(e,t){try{var r=void 0;if(t?(r=t).location.assign(e):void 0===t&&(r=mo.openSizedPopup(e)),!r)throw kn.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.authModule.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(un)),kn.createPopupWindowError(e.toString())}},mo.openSizedPopup=function(e){void 0===e&&(e="about:blank");var t=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=Math.max(0,n/2-ln/2+t),a=Math.max(0,o/2-pn/2+r);return window.open(e,he.LIBRARY_NAME,"width="+ln+", height="+pn+", top="+a+", left="+i)},mo.prototype.unloadWindow=function(e){this.browserStorage.cleanRequest(),this.currentWindow.close(),delete e.returnValue},mo.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(un))},mo);function mo(e,t){var r=yo.call(this,e,t)||this;return r.unloadWindow=r.unloadWindow.bind(r),r}var Eo,vo=(e(Co,Eo=po),Co.prototype.initiateAuthRequest=function(r,n){return f(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:if(Z.isEmpty(r))throw this.authModule.logger.info("Navigate url is empty"),kn.createEmptyNavigationUriError();return this.authCodeRequest=n,this.navigateFrameWait?[4,this.loadFrame(r)]:[3,2];case 1:return t=e.sent(),[3,3];case 2:t=this.loadFrameSync(r),e.label=3;case 3:return[2,t]}})})},Co.prototype.monitorIframeForHash=function(a,e){var s=this;return new Promise(function(r,n){e<ao&&s.authModule.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+e+"ms) than the default ("+ao+"ms). This may result in timeouts.");var o=window.performance.now()+e,i=setInterval(function(){if(window.performance.now()>o)return s.removeHiddenIframe(a),clearInterval(i),void n(kn.createMonitorIframeTimeoutError());var e;try{e=a.contentWindow.location.href}catch(e){}if(!Z.isEmpty(e)){var t=a.contentWindow.location.hash;return mt.hashContainsKnownProperties(t)?(s.removeHiddenIframe(a),clearInterval(i),void r(t)):void 0}},fn)})},Co.prototype.loadFrame=function(n){var o=this;return new Promise(function(e,t){var r=o.createHiddenIframe();setTimeout(function(){r?(r.src=n,e(r)):t("Unable to load iframe")},o.navigateFrameWait)})},Co.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},Co.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},Co.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},Co);function Co(e,t,r){var n=Eo.call(this,e,t)||this;return n.navigateFrameWait=r,n}var To;(To=y.EventType||(y.EventType={})).LOGIN_START="msal:loginStart",To.LOGIN_SUCCESS="msal:loginSuccess",To.LOGIN_FAILURE="msal:loginFailure",To.ACQUIRE_TOKEN_START="msal:acquireTokenStart",To.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",To.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",To.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",To.SSO_SILENT_START="msal:ssoSilentStart",To.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",To.SSO_SILENT_FAILURE="msal:ssoSilentFailure",To.HANDLE_REDIRECT_START="msal:handleRedirectStart",To.HANDLE_REDIRECT_END="msal:handleRedirectEnd",To.LOGOUT_START="msal:logoutStart",To.LOGOUT_SUCCESS="msal:logoutSuccess",To.LOGOUT_FAILURE="msal:logoutFailure";var wo=(So.prototype.handleRedirectPromise=function(n){return f(this,void 0,void 0,function(){var t,r=this;return g(this,function(e){return this.emitEvent(y.EventType.HANDLE_REDIRECT_START,y.InteractionType.Redirect),t=this.getAllAccounts(),this.isBrowserEnvironment?[2,this.handleRedirectResponse(n).then(function(e){return e&&(t.length<r.getAllAccounts().length?r.emitEvent(y.EventType.LOGIN_SUCCESS,y.InteractionType.Redirect,e):r.emitEvent(y.EventType.ACQUIRE_TOKEN_SUCCESS,y.InteractionType.Redirect,e)),r.emitEvent(y.EventType.HANDLE_REDIRECT_END,y.InteractionType.Redirect),e}).catch(function(e){throw 0<t.length?r.emitEvent(y.EventType.ACQUIRE_TOKEN_FAILURE,y.InteractionType.Redirect,null,e):r.emitEvent(y.EventType.LOGIN_FAILURE,y.InteractionType.Redirect,null,e),r.emitEvent(y.EventType.HANDLE_REDIRECT_END,y.InteractionType.Redirect),e})]:[2,null]})})},So.prototype.handleRedirectResponse=function(s){return f(this,void 0,void 0,function(){var t,r,n,o,i,a;return g(this,function(e){switch(e.label){case 0:return this.interactionInProgress()?(t=this.getRedirectResponseHash(s||window.location.hash),Z.isEmpty(t)?[2,null]:(r=this.browserStorage.getTemporaryCache(nn.ORIGIN_URI,!0),n=mt.removeHashFromUrl(r||""),o=mt.removeHashFromUrl(window.location.href),n===o&&this.config.auth.navigateToLoginRequestUrl?[4,this.handleHash(t)]:[3,2])):(this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null]);case 1:return i=e.sent(),-1<r.indexOf("#")&&no.replaceHash(r),[2,i];case 2:return this.config.auth.navigateToLoginRequestUrl?[3,3]:[2,this.handleHash(t)];case 3:return no.isInIframe()?[3,7]:(this.browserStorage.setTemporaryCache(nn.URL_HASH,t,!0),r&&"null"!==r?[3,5]:(a=no.getHomepage(),this.browserStorage.setTemporaryCache(nn.ORIGIN_URI,a,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,no.navigateWindow(a,this.config.system.redirectNavigationTimeout,this.logger,!0)]));case 4:return e.sent(),[3,7];case 5:return[4,no.navigateWindow(r,this.config.system.redirectNavigationTimeout,this.logger,!0)];case 6:e.sent(),e.label=7;case 7:return[2,null]}})})},So.prototype.getRedirectResponseHash=function(e){var t=mt.hashContainsKnownProperties(e),r=this.browserStorage.getTemporaryCache(nn.URL_HASH,!0);this.browserStorage.removeItem(this.browserStorage.generateCacheKey(nn.URL_HASH));var n=t?e:r;if(n){var o=mt.getDeserializedHash(n);return co.extractBrowserRequestState(this.browserCrypto,o.state).interactionType!==y.InteractionType.Redirect?null:(no.clearHash(),n)}var i=co.parseServerResponseFromHash(e);return this.browserStorage.cleanRequest(i.state),null},So.prototype.handleHash=function(c){return f(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return g(this,function(e){switch(e.label){case 0:t=this.browserStorage.getTemporaryCache(nn.REQUEST_PARAMS,!0),r=JSON.parse(this.browserCrypto.base64Decode(t)),n=this.initializeServerTelemetryManager(an.handleRedirectPromise,r.correlationId),o=co.parseServerResponseFromHash(c),e.label=1;case 1:return e.trys.push([1,4,,5]),i=this.browserStorage.getCachedAuthority(o.state),[4,this.createAuthCodeClient(n,i)];case 2:return a=e.sent(),[4,new ho(a,this.browserStorage,this.browserCrypto).handleCodeResponse(c,this.config.auth.clientId)];case 3:return[2,e.sent()];case 4:throw s=e.sent(),n.cacheFailedRequest(s),this.browserStorage.cleanRequest(o.state),s;case 5:return[2]}})})},So.prototype.acquireTokenRedirect=function(h){return f(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c,u;return g(this,function(e){switch(e.label){case 0:this.preflightBrowserEnvironmentCheck(y.InteractionType.Redirect),(t=0<this.getAllAccounts().length)?this.emitEvent(y.EventType.ACQUIRE_TOKEN_START,y.InteractionType.Redirect,h):this.emitEvent(y.EventType.LOGIN_START,y.InteractionType.Redirect,h),r=this.preflightInteractiveRequest(h,y.InteractionType.Redirect),n=this.initializeServerTelemetryManager(an.acquireTokenRedirect,r.correlationId),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return o=e.sent(),[4,this.createAuthCodeClient(n,r.authority)];case 3:return i=e.sent(),a=new ho(i,this.browserStorage,this.browserCrypto),[4,i.getAuthCodeUrl(r)];case 4:return s=e.sent(),c=h&&h.redirectStartPage||window.location.href,[2,a.initiateAuthRequest(s,o,this.config.system.redirectNavigationTimeout,c,h.onRedirectNavigate)];case 5:throw u=e.sent(),t?this.emitEvent(y.EventType.ACQUIRE_TOKEN_FAILURE,y.InteractionType.Redirect,null,u):this.emitEvent(y.EventType.LOGIN_FAILURE,y.InteractionType.Redirect,null,u),n.cacheFailedRequest(u),this.browserStorage.cleanRequest(r.state),u;case 6:return[2]}})})},So.prototype.acquireTokenPopup=function(e){try{this.preflightBrowserEnvironmentCheck(y.InteractionType.Popup)}catch(e){return Promise.reject(e)}if(this.config.system.asyncPopups)return this.acquireTokenPopupAsync(e);var t=go.openSizedPopup();return this.acquireTokenPopupAsync(e,t)},So.prototype.acquireTokenPopupAsync=function(l,p){return f(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c,u,h,d;return g(this,function(e){switch(e.label){case 0:0<(t=this.getAllAccounts()).length?this.emitEvent(y.EventType.ACQUIRE_TOKEN_START,y.InteractionType.Popup,l):this.emitEvent(y.EventType.LOGIN_START,y.InteractionType.Popup,l),r=this.preflightInteractiveRequest(l,y.InteractionType.Popup),n=this.initializeServerTelemetryManager(an.acquireTokenPopup,r.correlationId),e.label=1;case 1:return e.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return o=e.sent(),[4,this.createAuthCodeClient(n,r.authority)];case 3:return[4,(i=e.sent()).getAuthCodeUrl(r)];case 4:return a=e.sent(),s=new go(i,this.browserStorage),c=s.initiateAuthRequest(a,o,p),[4,s.monitorPopupForHash(c,this.config.system.windowHashTimeout)];case 5:return u=e.sent(),Gt.removeThrottle(this.browserStorage,this.config.auth.clientId,o.authority,o.scopes),[4,s.handleCodeResponse(u)];case 6:return h=e.sent(),t.length<this.getAllAccounts().length?this.emitEvent(y.EventType.LOGIN_SUCCESS,y.InteractionType.Popup,h):this.emitEvent(y.EventType.ACQUIRE_TOKEN_SUCCESS,y.InteractionType.Popup,h),[2,h];case 7:throw d=e.sent(),0<t.length?this.emitEvent(y.EventType.ACQUIRE_TOKEN_FAILURE,y.InteractionType.Popup,null,d):this.emitEvent(y.EventType.LOGIN_FAILURE,y.InteractionType.Popup,null,d),n.cacheFailedRequest(d),this.browserStorage.cleanRequest(r.state),d;case 8:return[2]}})})},So.prototype.ssoSilent=function(n){return f(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:this.preflightBrowserEnvironmentCheck(y.InteractionType.Silent),this.emitEvent(y.EventType.SSO_SILENT_START,y.InteractionType.Silent,n),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.acquireTokenByIframe(n)];case 2:return t=e.sent(),this.emitEvent(y.EventType.SSO_SILENT_SUCCESS,y.InteractionType.Silent,t),[2,t];case 3:throw r=e.sent(),this.emitEvent(y.EventType.SSO_SILENT_FAILURE,y.InteractionType.Silent,null,r),r;case 4:return[2]}})})},So.prototype.acquireTokenByIframe=function(s){return f(this,void 0,void 0,function(){var t,r,n,o,i,a;return g(this,function(e){switch(e.label){case 0:if(Z.isEmpty(s.loginHint)&&Z.isEmpty(s.sid)&&(!s.account||Z.isEmpty(s.account.username)))throw kn.createSilentSSOInsufficientInfoError();if(s.prompt&&s.prompt!==pe.NONE)throw kn.createSilentPromptValueError(s.prompt);t=this.initializeAuthorizationRequest(h(h({},s),{prompt:pe.NONE}),y.InteractionType.Silent),r=this.initializeServerTelemetryManager(an.ssoSilent,t.correlationId),e.label=1;case 1:return e.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=e.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return[4,(o=e.sent()).getAuthCodeUrl(t)];case 4:return i=e.sent(),[4,this.silentTokenHelper(i,n,o)];case 5:return[2,e.sent()];case 6:throw a=e.sent(),r.cacheFailedRequest(a),this.browserStorage.cleanRequest(t.state),a;case 7:return[2]}})})},So.prototype.acquireTokenByRefreshToken=function(s){return f(this,void 0,void 0,function(){var t,r,n,o,i,a;return g(this,function(e){switch(e.label){case 0:this.emitEvent(y.EventType.ACQUIRE_TOKEN_NETWORK_START,y.InteractionType.Silent,s),no.blockReloadInHiddenIframes(),t=h(h({},s),this.initializeBaseRequest(s)),r=this.initializeServerTelemetryManager(an.acquireTokenSilent_silentFlow,t.correlationId),e.label=1;case 1:return e.trys.push([1,4,,7]),[4,this.createRefreshTokenClient(r,t.authority)];case 2:return[4,e.sent().acquireTokenByRefreshToken(t)];case 3:return[2,e.sent()];case 4:return n=e.sent(),r.cacheFailedRequest(n),o=n instanceof xt,i=n instanceof fr,a=n.errorCode===dn,o&&a&&!i?[4,this.acquireTokenByIframe(s)]:[3,6];case 5:return[2,e.sent()];case 6:throw n;case 7:return[2]}})})},So.prototype.silentTokenHelper=function(o,i,a){return f(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return[4,(t=new vo(a,this.browserStorage,this.config.system.navigateFrameWait)).initiateAuthRequest(o,i)];case 1:return r=e.sent(),[4,t.monitorIframeForHash(r,this.config.system.iframeHashTimeout)];case 2:return n=e.sent(),[2,t.handleCodeResponse(n)]}})})},So.prototype.logout=function(i){return f(this,void 0,void 0,function(){var t,r,n,o;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.preflightBrowserEnvironmentCheck(y.InteractionType.Silent),this.emitEvent(y.EventType.LOGOUT_START,y.InteractionType.Redirect,i),t=this.initializeLogoutRequest(i),[4,this.createAuthCodeClient(null,i&&i.authority)];case 1:return r=e.sent(),n=r.getLogoutUri(t),this.emitEvent(y.EventType.LOGOUT_SUCCESS,y.InteractionType.Redirect,t),i&&"function"==typeof i.onRedirectNavigate?!1!==i.onRedirectNavigate(n)?(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[2,no.navigateWindow(n,this.config.system.redirectNavigationTimeout,this.logger)]):(this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),[3,3]):[2,no.navigateWindow(n,this.config.system.redirectNavigationTimeout,this.logger)];case 2:throw o=e.sent(),this.emitEvent(y.EventType.LOGOUT_FAILURE,y.InteractionType.Redirect,null,o),o;case 3:return[2]}})})},So.prototype.getAllAccounts=function(){return this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},So.prototype.getAccountByUsername=function(t){var e=this.getAllAccounts();return!Z.isEmpty(t)&&e&&e.length&&e.filter(function(e){return e.username.toLowerCase()===t.toLowerCase()})[0]||null},So.prototype.getAccountByHomeId=function(t){var e=this.getAllAccounts();return!Z.isEmpty(t)&&e&&e.length&&e.filter(function(e){return e.homeAccountId===t})[0]||null},So.prototype.getAccountByLocalId=function(t){var e=this.getAllAccounts();return!Z.isEmpty(t)&&e&&e.length&&e.filter(function(e){return e.localAccountId===t})[0]||null},So.prototype.getRedirectUri=function(e){var t=e||this.config.auth.redirectUri||no.getCurrentUri();return mt.getAbsoluteUrl(t,no.getCurrentUri())},So.prototype.getPostLogoutRedirectUri=function(e){var t=e||this.config.auth.postLogoutRedirectUri||no.getCurrentUri();return mt.getAbsoluteUrl(t,no.getCurrentUri())},So.prototype.getDiscoveredDefaultAuthority=function(){return f(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return this.defaultAuthority?[3,2]:(t=this,[4,Wr.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.config.auth.protocolMode)]);case 1:t.defaultAuthority=e.sent(),e.label=2;case 2:return[2,this.defaultAuthority]}})})},So.prototype.interactionInProgress=function(){return this.browserStorage.getTemporaryCache(un,!0)===hn},So.prototype.createAuthCodeClient=function(r,n){return f(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new kr(t)]}})})},So.prototype.createSilentFlowClient=function(r,n){return f(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new Gr(t)]}})})},So.prototype.createRefreshTokenClient=function(r,n){return f(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new Mr(t)]}})})},So.prototype.getClientConfiguration=function(n,o){return f(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return Z.isEmpty(o)||o===this.config.auth.authority?[3,2]:[4,Wr.createDiscoveredInstance(o,this.config.system.networkClient,this.config.auth.protocolMode)];case 1:return r=e.sent(),[3,4];case 2:return[4,this.getDiscoveredDefaultAuthority()];case 3:r=e.sent(),e.label=4;case 4:return t=r,[2,{authOptions:{clientId:this.config.auth.clientId,authority:t,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,clientCapabilities:this.config.auth.clientCapabilities,protocolMode:this.config.auth.protocolMode},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:n,libraryInfo:{sku:yn,version:"2.7.0",cpu:"",os:""}}]}})})},So.prototype.preflightInteractiveRequest=function(e,t){if(no.blockReloadInHiddenIframes(),this.interactionInProgress())throw kn.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},So.prototype.preflightBrowserEnvironmentCheck=function(e){if(no.blockNonBrowserEnvironment(this.isBrowserEnvironment),no.blockReloadInHiddenIframes(),e===y.InteractionType.Redirect&&this.config.cache.cacheLocation===y.BrowserCacheLocation.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw jn.createInMemoryRedirectUnavailableError()},So.prototype.initializeBaseRequest=function(e){var t=e.authority;Z.isEmpty(t)&&(t=this.config.auth.authority);var r=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}(e&&e.scopes||[]),n=e&&e.correlationId||this.browserCrypto.createNewGuid();return h(h({},e),{correlationId:n,authority:t,scopes:r})},So.prototype.initializeServerTelemetryManager=function(e,t,r){var n={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1};return new Zr(n,this.browserStorage)},So.prototype.initializeAuthorizationRequest=function(e,t){var r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=vr.setRequestState(this.browserCrypto,e&&e.state||"",n),i=e.nonce;Z.isEmpty(i)&&(i=this.browserCrypto.createNewGuid());var a=e.authenticationScheme||y.AuthenticationScheme.BEARER,s=h(h({},this.initializeBaseRequest(e)),{redirectUri:r,state:o,nonce:i,responseMode:fe.FRAGMENT,authenticationScheme:a});if(Z.isEmpty(s.loginHint)){var c=this.browserStorage.getTemporaryCache(re.ADAL_ID_TOKEN);if(!Z.isEmpty(c)){var u=new Zt(c,this.browserCrypto);this.browserStorage.removeItem(re.ADAL_ID_TOKEN),u.claims&&u.claims.upn&&(s.loginHint=u.claims.upn)}}return this.browserStorage.updateCacheEntries(s.state,s.nonce,s.authority),s},So.prototype.initializeAuthorizationCodeRequest=function(n){return f(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=e.sent(),r=h(h({},n),{redirectUri:n.redirectUri,code:"",codeVerifier:t.verifier}),n.codeChallenge=t.challenge,n.codeChallengeMethod=he.S256_CODE_CHALLENGE_METHOD,[2,r]}})})},So.prototype.initializeLogoutRequest=function(e){var t=h({correlationId:this.browserCrypto.createNewGuid()},e);return t.postLogoutRedirectUri=this.getPostLogoutRedirectUri(e?e.postLogoutRedirectUri:""),t},So.prototype.emitEvent=function(r,e,t,n){var o=this;if(this.isBrowserEnvironment){var i={eventType:r,interactionType:e||null,payload:t||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+r),this.eventCallbacks.forEach(function(e,t){o.logger.verbose("Emitting event to callback "+t+": "+r),e.apply(null,[i])})}},So.prototype.addEventCallback=function(e){if(this.isBrowserEnvironment){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},So.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},So.prototype.getLogger=function(){return this.logger},So.prototype.setLogger=function(e){this.logger=e},So);function So(e){this.isBrowserEnvironment="undefined"!=typeof window,this.isBrowserEnvironment&&(this.config=function(e){var t=e.auth,r=e.cache,n=e.system,o={clientId:"",authority:""+he.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:y.ProtocolMode.AAD},i={cacheLocation:y.BrowserCacheLocation.SessionStorage,storeAuthStateInCookie:!1},a=h(h({},Ut),{loggerOptions:{loggerCallback:function(){},piiLoggingEnabled:!1},networkClient:no.getBrowserNetworkClient(),windowHashTimeout:n&&n.loadFrameTimeout||io,iframeHashTimeout:n&&n.loadFrameTimeout||ao,navigateFrameWait:no.detectIEOrEdge()?500:0,redirectNavigationTimeout:so,asyncPopups:!1});return{auth:h(h({},o),t),cache:h(h({},i),r),system:h(h({},a),n)}}(e),this.browserCrypto=new xn,this.networkClient=this.config.system.networkClient,this.logger=new Fe(this.config.system.loggerOptions,"@azure/msal-browser","2.7.0"),this.browserStorage=new Xn(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger),this.eventCallbacks=new Map,Ct.setTrustedAuthoritiesFromConfig(this.config.auth.knownAuthorities,this.config.auth.cloudDiscoveryMetadata),this.defaultAuthority=null)}var Io,Ao=(e(Ro,Io=wo),Ro.prototype.loginRedirect=function(t){return f(this,void 0,void 0,function(){return g(this,function(e){return[2,this.acquireTokenRedirect(t||gn)]})})},Ro.prototype.loginPopup=function(e){return this.acquireTokenPopup(e||gn)},Ro.prototype.acquireTokenSilent=function(a){return f(this,void 0,void 0,function(){var t,r,n,o,i;return g(this,function(e){switch(e.label){case 0:this.preflightBrowserEnvironmentCheck(y.InteractionType.Silent),t=h(h(h({},a),this.initializeBaseRequest(a)),{forceRefresh:a.forceRefresh||!1}),this.emitEvent(y.EventType.ACQUIRE_TOKEN_START,y.InteractionType.Silent,a),e.label=1;case 1:return e.trys.push([1,4,,9]),r=this.initializeServerTelemetryManager(an.acquireTokenSilent_silentFlow,t.correlationId),[4,this.createSilentFlowClient(r,t.authority)];case 2:return[4,e.sent().acquireCachedToken(t)];case 3:return n=e.sent(),this.emitEvent(y.EventType.ACQUIRE_TOKEN_SUCCESS,y.InteractionType.Silent,n),[2,n];case 4:e.sent(),e.label=5;case 5:return e.trys.push([5,7,,8]),[4,this.acquireTokenByRefreshToken(t)];case 6:return o=e.sent(),this.emitEvent(y.EventType.ACQUIRE_TOKEN_SUCCESS,y.InteractionType.Silent,o),[2,o];case 7:throw i=e.sent(),this.emitEvent(y.EventType.ACQUIRE_TOKEN_FAILURE,y.InteractionType.Silent,null,i),i;case 8:return[3,9];case 9:return[2]}})})},Ro);function Ro(e){return Io.call(this,e)||this}var _o={acquireTokenPopup:function(){return Promise.reject(jn.createStubPcaInstanceCalledError)},acquireTokenRedirect:function(){return Promise.reject(jn.createStubPcaInstanceCalledError)},acquireTokenSilent:function(){return Promise.reject(jn.createStubPcaInstanceCalledError)},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(jn.createStubPcaInstanceCalledError)},loginPopup:function(){return Promise.reject(jn.createStubPcaInstanceCalledError)},loginRedirect:function(){return Promise.reject(jn.createStubPcaInstanceCalledError)},logout:function(){return Promise.reject(jn.createStubPcaInstanceCalledError)},ssoSilent:function(){return Promise.reject(jn.createStubPcaInstanceCalledError)},addEventCallback:function(){return null},removeEventCallback:function(){},getLogger:function(){throw jn.createStubPcaInstanceCalledError()},setLogger:function(){}};y.AuthError=c,y.AuthErrorMessage=r,y.BrowserAuthError=kn,y.BrowserAuthErrorMessage=On,y.BrowserConfigurationAuthError=jn,y.BrowserConfigurationAuthErrorMessage=Bn,y.InteractionRequiredAuthError=fr,y.Logger=Fe,y.PublicClientApplication=Ao,y.stubbedPublicClientApplication=_o,Object.defineProperty(y,"__esModule",{value:!0})});
